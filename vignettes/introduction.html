<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Lucas Freitas" />

<meta name="date" content="2025-12-16" />

<title>TWoLife: Simulating Populations with Individual Variation in Heterogeneous Landscapes</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">TWoLife: Simulating Populations with
Individual Variation in Heterogeneous Landscapes</h1>
<h4 class="author">Lucas Freitas</h4>
<h4 class="date">2025-12-16</h4>


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#package-setup" id="toc-package-setup">Package
Setup</a></li>
<li><a href="#package-overview" id="toc-package-overview">Package
Overview</a>
<ul>
<li><a href="#main-function" id="toc-main-function">Main
Function</a></li>
<li><a href="#key-concepts" id="toc-key-concepts">Key Concepts</a></li>
<li><a href="#simulation-output" id="toc-simulation-output">Simulation
Output</a></li>
<li><a href="#basic-workflow" id="toc-basic-workflow">Basic
Workflow</a></li>
</ul></li>
<li><a href="#basic-workflow-demonstration" id="toc-basic-workflow-demonstration">Basic Workflow Demonstration</a>
<ul>
<li><a href="#creating-landscapes" id="toc-creating-landscapes">Creating
Landscapes</a></li>
<li><a href="#running-simulations" id="toc-running-simulations">Running
Simulations</a></li>
<li><a href="#extracting-results" id="toc-extracting-results">Extracting
Results</a></li>
<li><a href="#summary" id="toc-summary">Summary</a></li>
</ul></li>
<li><a href="#main-analysis-individual-variation-in-heterogeneous-environments" id="toc-main-analysis-individual-variation-in-heterogeneous-environments">Main
Analysis: Individual Variation in Heterogeneous Environments</a>
<ul>
<li><a href="#background-and-motivation" id="toc-background-and-motivation">Background and Motivation</a></li>
<li><a href="#generating-continuous-landscapes" id="toc-generating-continuous-landscapes">Generating Continuous
Landscapes</a></li>
<li><a href="#experimental-design-progressive-mechanisms" id="toc-experimental-design-progressive-mechanisms">Experimental Design:
Progressive Mechanisms</a></li>
<li><a href="#scenario-1-uniform-perfect-specialists" id="toc-scenario-1-uniform-perfect-specialists">Scenario 1: Uniform
Perfect Specialists</a></li>
<li><a href="#scenario-2-variable-specialists" id="toc-scenario-2-variable-specialists">Scenario 2: Variable
Specialists</a></li>
<li><a href="#scenario-3-generalists-niche-width" id="toc-scenario-3-generalists-niche-width">Scenario 3: Generalists
(Niche Width)</a></li>
<li><a href="#scenario-4-evolution-mutation-plasticity" id="toc-scenario-4-evolution-mutation-plasticity">Scenario 4: Evolution
(Mutation + Plasticity)</a></li>
<li><a href="#scenario-5-habitat-selection-behavioral-optimization" id="toc-scenario-5-habitat-selection-behavioral-optimization">Scenario
5: Habitat Selection (Behavioral Optimization)</a></li>
<li><a href="#comparative-analysis" id="toc-comparative-analysis">Comparative Analysis</a></li>
<li><a href="#verifying-phenotype-environment-matching" id="toc-verifying-phenotype-environment-matching">Verifying
Phenotype-Environment Matching</a></li>
</ul></li>
<li><a href="#understanding-simulation-output" id="toc-understanding-simulation-output">Understanding Simulation
Output</a>
<ul>
<li><a href="#object-structure" id="toc-object-structure">Object
Structure</a></li>
<li><a href="#accessing-individual-level-data" id="toc-accessing-individual-level-data">Accessing Individual-Level
Data</a></li>
<li><a href="#accessing-event-history" id="toc-accessing-event-history">Accessing Event History</a></li>
<li><a href="#accessing-parameters" id="toc-accessing-parameters">Accessing Parameters</a></li>
</ul></li>
<li><a href="#parameters-reference" id="toc-parameters-reference">Parameters Reference</a>
<ul>
<li><a href="#landscape-parameters-landscape_params-list" id="toc-landscape-parameters-landscape_params-list">Landscape Parameters
(<code>landscape_params</code> list)</a></li>
<li><a href="#individual-parameters-individual_params-list" id="toc-individual-parameters-individual_params-list">Individual
Parameters (<code>individual_params</code> list)</a></li>
<li><a href="#genetic-parameters-genetic_params-list-optional" id="toc-genetic-parameters-genetic_params-list-optional">Genetic
Parameters (<code>genetic_params</code> list, optional)</a></li>
<li><a href="#simulation-parameters-simulation_params-list" id="toc-simulation-parameters-simulation_params-list">Simulation
Parameters (<code>simulation_params</code> list)</a></li>
<li><a href="#master-seed" id="toc-master-seed">Master Seed</a></li>
</ul></li>
<li><a href="#computational-considerations" id="toc-computational-considerations">Computational Considerations</a>
<ul>
<li><a href="#performance" id="toc-performance">Performance</a></li>
<li><a href="#memory-usage" id="toc-memory-usage">Memory Usage</a></li>
<li><a href="#reproducibility" id="toc-reproducibility">Reproducibility</a></li>
<li><a href="#parallelization" id="toc-parallelization">Parallelization</a></li>
</ul></li>
<li><a href="#discussion" id="toc-discussion">Discussion</a>
<ul>
<li><a href="#what-twolife-enables" id="toc-what-twolife-enables">What
TWoLife Enables</a></li>
</ul></li>
<li><a href="#conclusion" id="toc-conclusion">Conclusion</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Understanding population dynamics in spatially heterogeneous
environments—where environmental conditions vary across space—requires
modeling both landscape structure (the spatial arrangement of
environmental conditions) and individual variation (differences among
individuals in traits affecting fitness) <span class="citation">(Turner
1989; Bolnick et al. 2011)</span>. Existing approaches typically
simplify one or both dimensions: agent-based models (computational
simulations tracking individual organisms) often assume discrete habitat
types (categorical suitable/unsuitable classifications) <span class="citation">(Grimm and Railsback 2005)</span>, while analytical
models (mathematical equations) treat individuals as identical units
<span class="citation">(Levins 1969; Hanski 1999)</span>.
<strong>TWoLife</strong> integrates these dimensions by simulating
populations as collections of genetically variable individuals
inhabiting spatially complex landscapes.</p>
<p>The package enables researchers to:</p>
<ol style="list-style-type: decimal">
<li>Generate landscapes with <strong>continuous environmental
gradients</strong> (smoothly varying conditions across space) or
<strong>discrete habitat patches</strong> (distinct areas of suitable
vs. unsuitable habitat)</li>
<li>Model <strong>individual genetic variation</strong> in optimal
environmental values (conditions where fitness is maximized), tolerance
ranges (breadth of survivable conditions), and behavioral strategies
(e.g., habitat selection decisions)</li>
<li>Implement <strong>evolutionary and adaptive mechanisms</strong>
including mutation (random genetic changes transmitted to offspring),
phenotypic plasticity (within-generation adjustment to environmental
conditions), and natural selection (differential survival based on
trait-environment matching)</li>
<li>Track <strong>phenotype-environment interactions</strong> (how well
individual traits match local conditions) that determine fitness and
spatial distribution</li>
<li>Analyze <strong>emergent population dynamics</strong>
(population-level patterns arising from individual decisions and fates)
from individual-level processes (birth, death, dispersal, and trait
evolution)</li>
</ol>
<p>This vignette demonstrates TWoLife’s capabilities through two
complementary analyses. We begin with a simplified example showing basic
workflow and discrete habitat structure, then proceed to the main
analysis showcasing individual genetic variation in continuous
environmental gradients—the core innovation of TWoLife.</p>
</div>
<div id="package-setup" class="section level1">
<h1>Package Setup</h1>
<p>Before using TWoLife functions, we load the package and set a seed
for reproducibility:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(TWoLife)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># Set seed for reproducible results across all subsequent operations</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
</div>
<div id="package-overview" class="section level1">
<h1>Package Overview</h1>
<div id="main-function" class="section level2">
<h2>Main Function</h2>
<p>TWoLife simulations are executed through a single main function that
accepts five components: three parameter lists controlling different
aspects of the simulation, plus master seed for reproducibility. The
function structure is:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">twolife_simulation</span>(</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  landscape_params,     <span class="co"># List: spatial environment configuration</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  individual_params,    <span class="co"># List: population initialization settings</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  genetic_params,       <span class="co"># List: individual variation (optional)</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  simulation_params,    <span class="co"># List: simulation control and stopping conditions</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  master_seed           <span class="co"># Integer: ensures complete reproducibility</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>)</span></code></pre></div>
<p>Each parameter list is a standard R list containing named elements.
The <code>landscape_params</code> list must include a habitat matrix.
The <code>individual_params</code> list specifies initial population
size and optional starting configurations. The
<code>genetic_params</code> list is optional—when omitted, individuals
use default genetic values (all identical with genotype=0.5, no
tolerance, no evolution). The <code>simulation_params</code> list
controls simulation duration through <code>max_events</code> or
<code>max_time</code>. The <code>master_seed</code> ensures all random
processes (initialization, demographic events, mutations) produce
identical results when re-run.</p>
</div>
<div id="key-concepts" class="section level2">
<h2>Key Concepts</h2>
<p><strong>Landscapes</strong></p>
<p>Spatial environments are represented as numeric matrices where each
cell contains an environmental value. TWoLife supports two landscape
types that differ fundamentally in how environmental variation is
represented:</p>
<ul>
<li><p><strong>Continuous landscapes</strong>: Environmental values vary
smoothly across space along gradients. Values typically range from 0.0
to 1.0, representing continuous variation in conditions such as
temperature (e.g., 0°C to 30°C rescaled to 0-1), moisture (e.g., 0% to
100% soil moisture), or resource availability. In continuous landscapes,
fitness depends on the match between individual phenotypes and local
environmental values through Gaussian matching. No locations are
inherently “unsuitable”—suitability emerges from the interaction between
individual traits and local conditions.</p></li>
<li><p><strong>Discrete landscapes</strong>: Space is divided into
binary categories where each cell is classified as either suitable
habitat (value=1) or unsuitable matrix (value=0). This representation is
common in fragmented landscapes where habitat patches are embedded in a
surrounding matrix that cannot support populations. In discrete
landscapes, individuals can only survive in habitat cells (value=1), and
matrix cells (value=0) are immediately lethal.</p></li>
</ul>
<p>Landscapes are generated using
<code>create_fractal_landscape()</code>, which produces realistic
spatial patterns with self-similar structure across spatial scales. The
fractal algorithm ensures that pattern complexity (patchiness
vs. smoothness) is similar whether the landscape is viewed at fine
resolution (individual cells) or coarse resolution (blocks of cells),
mimicking natural spatial processes.</p>
<p><strong>Individuals</strong></p>
<p>Each individual in TWoLife is a simulated organism (computational
agent) with heritable genetic traits. Unlike models where fitness is
pre-assigned by location type, fitness in TWoLife emerges dynamically
from phenotype-environment matching: how well an individual’s expressed
traits align with local environmental conditions determines survival
probability.</p>
<p>Individuals are characterized by five genetic attributes that
together determine ecological and evolutionary outcomes:</p>
<ul>
<li><p><strong><code>genotype_mean</code></strong> (Optimal
environmental value): The environmental condition at which the
individual achieves maximum fitness (survival probability = 1.0). This
represents the genetically-determined optimal niche position. Values
typically range from 0 to 1, matching the landscape’s environmental
scale. For example, an individual with genotype_mean=0.3 is genetically
adapted to environmental value 0.3 (e.g., cool temperatures if the
gradient represents temperature). When an individual occupies a location
with environmental value exactly matching its genotype_mean (adjusted by
plasticity), fitness equals 1.0.</p></li>
<li><p><strong><code>genotype_sd</code></strong> (Niche
width/tolerance): The breadth of environmental conditions the individual
can tolerate, represented mathematically as the standard deviation (σ)
in the Gaussian fitness function. This parameter controls how steeply
fitness declines as environmental conditions deviate from the optimum.
Smaller values (e.g., genotype_sd=0.05) indicate specialists with narrow
tolerance ranges who perform well only near their optimal value—fitness
drops rapidly with small environmental mismatches. Larger values (e.g.,
genotype_sd=0.3) indicate generalists with broad tolerance who maintain
high fitness across a wide range of conditions—fitness declines
gradually even with substantial environmental mismatches. A genotype_sd
of 0.15 means approximately 95% of fitness is retained within ±0.3 units
of the optimal value (±2σ).</p></li>
<li><p><strong><code>plasticity</code></strong> (Phenotypic plasticity
rate): The rate at which an individual’s expressed phenotype can shift
toward local environmental values within its lifetime. This parameter
controls within-generation acclimation capacity. Values range from 0 to
1:</p>
<ul>
<li>plasticity=0: No plasticity—the expressed phenotype permanently
equals genotype_mean regardless of local environment. The individual
cannot adjust.</li>
<li>plasticity=0.3: Moderate plasticity—each time step, the phenotype
shifts 30% of the distance from its current value toward the local
environmental value. This represents partial, gradual acclimation.</li>
<li>plasticity=1.0: Complete plasticity—the phenotype immediately
adjusts to perfectly match the local environmental value (within
tolerance limits set by genotype_sd). This represents instantaneous,
perfect acclimation.</li>
</ul>
<p>Plasticity represents reversible acclimation or behavioral
thermoregulation, not genetic change. If an individual with
plasticity=0.5, genotype_mean=0.4, and current phenotype=0.4 moves to a
location with environment=0.6, its phenotype shifts to 0.4 +
0.5×(0.6-0.4) = 0.5. Plasticity enables individuals to improve fitness
in sub-optimal conditions but cannot exceed the limits set by tolerance
(genotype_sd).</p></li>
<li><p><strong><code>mutation_rate</code></strong>: The probability that
offspring inherit a genotype_mean different from the parent value. When
mutation occurs (tested at each birth event), offspring genotype_mean is
drawn from a normal distribution centered on the parent’s genotype_mean
with standard deviation determined by the mutation rate. Typical values
range from 0 (no evolution) to 0.1 (10% chance per reproduction). For
example, with mutation_rate=0.05, each offspring has a 5% chance of
receiving a mutated genotype_mean drawn from
Normal(parent_genotype_mean, σ_mutation). This parameter enables
evolutionary adaptation across generations as beneficial mutations
(those increasing fitness in current conditions) accumulate and spread
through the population via natural selection.</p></li>
<li><p><strong><code>sampling_points</code></strong> (Habitat selection
intensity): The number of potential dispersal locations an individual
evaluates before deciding where to move. This parameter controls habitat
selection behavior:</p>
<ul>
<li>sampling_points=1: Random dispersal with no habitat selection. The
individual moves to a randomly chosen location without evaluation,
representing passive dispersal (e.g., wind-dispersed seeds).</li>
<li>sampling_points=10: Moderate selectivity. The individual evaluates
10 random locations and selects among them using a softmax function
weighted by expected fitness at each location, representing limited
assessment capacity.</li>
<li>sampling_points=100: High selectivity. The individual evaluates 100
locations, enabling sophisticated habitat selection that approaches
optimal placement, representing organisms with strong habitat assessment
abilities (e.g., birds evaluating multiple territories).</li>
</ul>
<p>Higher sampling_points values allow individuals to locate more
suitable microhabitats, but at computational cost. The softmax selection
process means individuals prefer high-fitness locations but retain some
randomness, preventing unrealistic determinism.</p></li>
</ul>
<p>All five attributes are heritable with modification (subject to
mutation), enabling evolutionary dynamics and potential local adaptation
over multiple generations. For example, if populations persist in
heterogeneous landscapes, natural selection may favor individuals with
broader tolerance (larger genotype_sd) or higher plasticity.</p>
<p><strong>Fitness</strong></p>
<p>Survival probability is determined by Gaussian matching—a
mathematical function that quantifies the match between an individual’s
phenotype and local environmental conditions:</p>
<p><span class="math display">\[\text{fitness} =
\exp\left(-\frac{(\text{phenotype} - \text{environment})^2}{2 \times
\text{tolerance}^2}\right)\]</span></p>
<p>where: - <strong>phenotype</strong> is the individual’s expressed
trait value, which equals genotype_mean initially but can shift through
plasticity toward local environmental values -
<strong>environment</strong> is the environmental value at the cell
where the individual currently resides (ranges from 0 to 1 in continuous
landscapes, or 0/1 in binary landscapes) - <strong>tolerance</strong> is
the individual’s genotype_sd (niche width parameter)</p>
<p>This Gaussian function produces a bell-shaped fitness curve centered
on the phenotype. When phenotype perfectly matches the local
environment, the numerator equals zero and fitness equals 1.0 (maximum
survival probability). As the mismatch increases, fitness declines
exponentially. The tolerance parameter controls the rate of decline:</p>
<ul>
<li><p><strong>Narrow tolerance</strong> (small genotype_sd, e.g.,
0.05): Fitness drops rapidly with small mismatches. An individual with
genotype_sd=0.05 has fitness ≈0.6 when mismatch is 0.05, and fitness
≈0.14 when mismatch is 0.1. These specialists require close matches to
survive.</p></li>
<li><p><strong>Broad tolerance</strong> (large genotype_sd, e.g., 0.3):
Fitness declines gradually even with substantial mismatches. An
individual with genotype_sd=0.3 maintains fitness ≈0.95 when mismatch is
0.05, and fitness ≈0.61 when mismatch is 0.1. These generalists survive
across wide environmental ranges.</p></li>
</ul>
<p>This fitness framework differs fundamentally from models with
pre-assigned habitat quality, where fitness depends only on location
type (e.g., habitat=suitable, matrix=unsuitable). In TWoLife, fitness
emerges dynamically from trait-environment interactions, allowing
investigation of adaptive matching, local adaptation, and niche
evolution without assuming fitness landscapes a priori.</p>
</div>
<div id="simulation-output" class="section level2">
<h2>Simulation Output</h2>
<p>Simulations return a list object containing four components that
provide different levels of detail about population outcomes:</p>
<ul>
<li><p><strong><code>summary</code></strong>: A list of final population
statistics including <code>final_population_size</code> (number
surviving at simulation end), <code>total_births</code> (cumulative
birth events), <code>total_deaths</code> (cumulative death events),
<code>total_dispersals</code> (cumulative dispersal events), and
<code>final_time</code> (simulation duration). This component provides a
quick overview of population outcomes.</p></li>
<li><p><strong><code>survivors</code></strong>: A data frame where each
row represents one surviving individual at simulation end. Columns
include <code>individual_id</code>, <code>genotype</code> (genotype_mean
value), <code>genotype_sd</code>, <code>phenotype</code> (current
expressed value), <code>x</code> and <code>y</code> (spatial
coordinates), <code>habitat_quality</code> (local environmental value),
and <code>fitness</code> (current survival probability). This component
enables analysis of trait distributions, spatial patterns, and
phenotype-environment matching among survivors.</p></li>
<li><p><strong><code>events</code></strong>: A data frame recording
every demographic event that occurred during the simulation. Each row
documents one event with columns: <code>time</code> (when event
occurred), <code>event_type</code> (“birth”, “death”, or “dispersal”),
<code>individual_id</code>, <code>parent_id</code> (for births),
<code>x</code> and <code>y</code> (location), and relevant trait values.
This complete history enables analysis of population dynamics,
demographic rates over time, and lineage tracking.</p></li>
<li><p><strong><code>parameters</code></strong>: A list storing all
input parameters (landscape_params, individual_params, genetic_params,
simulation_params, master_seed). This ensures complete
reproducibility—simulations can be exactly replicated by re-running with
stored parameters. It also enables systematic comparison across
parameter combinations.</p></li>
</ul>
</div>
<div id="basic-workflow" class="section level2">
<h2>Basic Workflow</h2>
<p>A typical TWoLife analysis follows five steps:</p>
<ol style="list-style-type: decimal">
<li><strong>Create landscape</strong>: Use
<code>create_fractal_landscape()</code> to generate spatial environments
with desired properties (continuous vs. discrete, spatial
autocorrelation level, habitat proportion)</li>
<li><strong>Configure parameters</strong>: Prepare the three parameter
lists (landscape_params, individual_params, genetic_params) specifying
landscape, initial population, and genetic attributes</li>
<li><strong>Run simulation</strong>: Execute
<code>twolife_simulation()</code> with parameters and master_seed</li>
<li><strong>Extract results</strong>: Access components of the output
list directly (e.g., <code>sim$summary$final_population_size</code>) or
use helper functions like <code>population_size()</code> to extract time
series</li>
<li><strong>Visualize</strong>: Use built-in plotting functions
(<code>plot_landscape()</code>, <code>check_habitat_match()</code>) or
create custom visualizations from survivors and events data</li>
</ol>
<p>This workflow enables rapid iteration through parameter combinations,
facilitating both exploratory analysis and systematic hypothesis
testing.</p>
</div>
</div>
<div id="basic-workflow-demonstration" class="section level1">
<h1>Basic Workflow Demonstration</h1>
<p>Before exploring TWoLife’s core capabilities (individual variation in
continuous landscapes), we demonstrate basic workflow using a simpler
scenario: discrete habitat/matrix landscapes—where suitable habitat
patches are embedded in an unsuitable matrix (the unsuitable areas
between patches). This introductory example shows the main function
structure, parameter organization, and output format using the classic
SLOSS (Single Large or Several Small) conservation debate: whether a
single large habitat reserve better supports populations than several
small reserves with the same total area <span class="citation">(<strong>Diamond1975?</strong>)</span>.</p>
<div id="creating-landscapes" class="section level2">
<h2>Creating Landscapes</h2>
<p>TWoLife provides <code>create_fractal_landscape()</code> for
generating spatial patterns with realistic spatial structure. The
fractal algorithm creates landscapes where pattern complexity is
self-similar across spatial scales—patchiness looks similar whether
viewing individual cells or large regions. This mimics natural processes
like topography or vegetation patterns.</p>
<p>The function accepts four key parameters for binary (discrete)
landscapes:</p>
<ul>
<li><code>cells_per_row</code>: Landscape resolution (e.g., 15 produces
a 15×15 grid = 225 total cells)</li>
<li><code>fractality</code>: Controls spatial autocorrelation (the
degree to which nearby cells have similar values). Values near 0 produce
high local variation with patchy patterns, while values near 1 produce
smooth, homogeneous landscapes. We use 0.5 for intermediate spatial
structure.</li>
<li><code>habitat_proportion</code>: For binary landscapes, this
specifies the fraction of cells classified as suitable habitat
(value=1). The remaining fraction becomes matrix (value=0). Setting this
to 1.0 creates 100% habitat (pristine landscape), while 0.2 creates 20%
habitat embedded in 80% matrix.</li>
<li><code>min_value</code> and <code>max_value</code>: Not used for
binary landscapes (always 0 and 1), but important for continuous
landscapes (discussed later).</li>
</ul>
<p>We create three landscape configurations to test the SLOSS
question:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Pristine landscape: 100% suitable habitat, no fragmentation</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>pristine_landscape <span class="ot">&lt;-</span> <span class="fu">create_fractal_landscape</span>(</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">cells_per_row =</span> <span class="dv">15</span>,      <span class="co"># 15×15 = 225 total cells</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="at">fractality =</span> <span class="fl">0.5</span>,        <span class="co"># Intermediate spatial structure  </span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="at">habitat_proportion =</span> <span class="fl">1.0</span> <span class="co"># 100% habitat (no matrix)</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co"># Pre-configured SLOSS landscapes from package data</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co"># Both have identical habitat area (20%) but different spatial configurations</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>single_large_patch <span class="ot">&lt;-</span> single_large      <span class="co"># 20% coverage concentrated in 1 large patch</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>several_small_patches <span class="ot">&lt;-</span> several_small  <span class="co"># 20% coverage distributed across multiple small patches</span></span></code></pre></div>
<p>The figure below visualizes these three landscape configurations.
Dark green indicates suitable habitat (value=1), while white indicates
unsuitable matrix (value=0). All three configurations will be
initialized with 100 individuals to test how spatial arrangement affects
population outcomes:</p>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="running-simulations" class="section level2">
<h2>Running Simulations</h2>
<p>The core <code>twolife_simulation()</code> function requires three
parameter lists plus a master seed. Each list is a standard R list
containing named elements that control different simulation aspects:</p>
<p><strong>landscape_params</strong>: A list containing the habitat
matrix and optional environmental values. For this basic example, we
provide only the habitat component—a matrix where 1=suitable habitat and
0=unsuitable matrix. The function interprets this binary matrix as a
discrete landscape where individuals can only survive in habitat
cells.</p>
<p><strong>individual_params</strong>: A list controlling initial
population configuration. The <code>initial_population_size</code>
element specifies how many individuals to place at simulation start
(here, 100). Additional optional elements include
<code>initial_positions</code> (custom starting locations; default is
random placement in habitat cells) and <code>initial_ages</code> (age
distribution; default is all age 0).</p>
<p><strong>genetic_params</strong>: A list specifying individual trait
values. When omitted (as in this basic example), all individuals use
default values: genotype_mean=0.5, genotype_sd=0.1, mutation_rate=0,
plasticity=0, sampling_points=1. These defaults create a genetically
uniform population with moderate tolerance, no evolution, and random
dispersal—appropriate for testing landscape effects without genetic
complications.</p>
<p><strong>simulation_params</strong>: A list controlling simulation
duration and stopping conditions. The <code>max_events</code> element
specifies how many demographic events (births, deaths, dispersals
combined) to execute before stopping. Here we use 300 events, sufficient
to observe population dynamics without excessive computation.
Alternatively, <code>max_time</code> could specify simulation duration
in time units.</p>
<p><strong>master_seed</strong>: An integer ensuring reproducibility.
All random processes (initial placement, birth/death/dispersal events,
mutations, habitat selection) use this seed, guaranteeing identical
results when the simulation is re-run with the same seed. Different
seeds produce different random realizations while keeping all mechanisms
identical.</p>
<p>We run three simulations, one per landscape configuration, using
identical population and simulation parameters. Only the landscape
differs, isolating its effect:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>sim_pristine <span class="ot">&lt;-</span> <span class="fu">twolife_simulation</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="at">landscape_params =</span> <span class="fu">list</span>(<span class="at">habitat =</span> pristine_landscape),</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">individual_params =</span> <span class="fu">list</span>(<span class="at">initial_population_size =</span> <span class="dv">100</span>),</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">simulation_params =</span> <span class="fu">list</span>(<span class="at">max_events =</span> <span class="dv">300</span>),</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">master_seed =</span> <span class="dv">42</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>sim_single_large <span class="ot">&lt;-</span> <span class="fu">twolife_simulation</span>(</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  <span class="at">landscape_params =</span> <span class="fu">list</span>(<span class="at">habitat =</span> single_large_patch),</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="at">individual_params =</span> <span class="fu">list</span>(<span class="at">initial_population_size =</span> <span class="dv">100</span>),</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  <span class="at">simulation_params =</span> <span class="fu">list</span>(<span class="at">max_events =</span> <span class="dv">300</span>),</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>  <span class="at">master_seed =</span> <span class="dv">43</span>  <span class="co"># Different seed for independent realization</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>)</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>sim_several_small <span class="ot">&lt;-</span> <span class="fu">twolife_simulation</span>(</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>  <span class="at">landscape_params =</span> <span class="fu">list</span>(<span class="at">habitat =</span> several_small_patches),</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>  <span class="at">individual_params =</span> <span class="fu">list</span>(<span class="at">initial_population_size =</span> <span class="dv">100</span>),</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>  <span class="at">simulation_params =</span> <span class="fu">list</span>(<span class="at">max_events =</span> <span class="dv">300</span>),</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>  <span class="at">master_seed =</span> <span class="dv">44</span>  <span class="co"># Different seed for independent realization</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>)</span></code></pre></div>
<p>Note that we use different master seeds (42, 43, 44) for the three
simulations. This ensures independent random realizations—each
simulation experiences different sequences of demographic events. Using
identical seeds would make comparisons less meaningful because
differences could arise from particular random events rather than
landscape structure.</p>
</div>
<div id="extracting-results" class="section level2">
<h2>Extracting Results</h2>
<p>Simulation objects are lists containing multiple components (summary,
survivors, events, parameters). The <code>summary</code> component
provides aggregated statistics about final population outcomes. We
extract final population sizes to compare configurations:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Extract final population sizes from summary component</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>final_pops <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">Pristine =</span> sim_pristine<span class="sc">$</span>summary<span class="sc">$</span>final_population_size,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">Single_Large =</span> sim_single_large<span class="sc">$</span>summary<span class="sc">$</span>final_population_size,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="at">Several_Small =</span> sim_several_small<span class="sc">$</span>summary<span class="sc">$</span>final_population_size</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>final_pops</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt;      Pristine  Single_Large Several_Small </span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt;           436            67            12</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co"># Population trajectories using helper function</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co"># population_size() extracts time series from events component</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>trajectory_pristine <span class="ot">&lt;-</span> <span class="fu">population_size</span>(sim_pristine)</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="fu">head</span>(trajectory_pristine, <span class="dv">3</span>)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt;   time population_size</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; 1    0               1</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; 2    0               2</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; 3    0               3</span></span></code></pre></div>
<p>The <code>population_size()</code> helper function processes the
events component to compute population size at each time point. It
returns a data frame with <code>time</code> and
<code>population_size</code> columns, enabling visualization of
population dynamics over simulation duration.</p>
<p>The figure below compares final population sizes (left panel) and
population dynamics over time (right panel) across the three landscape
configurations. The left panel shows that reducing habitat from 100%
(pristine) to 20% causes substantial population decline. The right panel
reveals temporal dynamics: populations may grow initially, decline due
to deaths exceeding births, or fluctuate around equilibrium depending on
landscape carrying capacity:</p>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwAAAAGACAMAAAAtcPVNAAAA21BMVEUAAAAAADoAAGYAAP8AFwAAKAAAOQAAOjoAOmYAOpAARwAAVgAAZAAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmZmZmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQttuQtv+Q29uQ2/+2ZgC2Zjq2ZpC2kGa2tma225C227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb2//b/7bb////AAD/tmb/25D/27b//7b//9v///+vETxTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2dC3vktnWGKckr70pTydmkTjSu2ySWYtft0m0S29Fk40aidsT//4tK3AESAAESHF7wfc+zKw4HF87heYkbARQ1BGWsYu4LgKA5BQCgrAUAoKwFAKCsBQCgrAUAoKwFAKCsBQCgrAUAoKwFAKCsBQCgrAUAoKwFAKCsBQCgrAUAoKwFAKCsBQCgrAUAoKwFAKCsBQCgrAUAoKwFAKCsdVoADgXX+ePrQ/HuyRFM+07E+M1PYTl0k339n0fLWUvM/31fFGdf/mRNZEM6mUV5RsykA3Sau7AWAIqzD0E5dJL99PV50O1qgrB87jMBYHKLqozuB13oxgHwBbMBEGiMjtXKnrwiL239Or1FQ1GbRacGQNqC2bU58d8/FMVbevYfX5OS+UMLAGrtT3sW8x//XhSf/55819yGvzYf3v5Ui1ty3Bd3IqpMqqQ+/TeeoIpuZFzTNM6+afJpyoF7lkiTnLx7r03Qs9/SS/r7+xGl+hJ0MovyjH5pIt40idyQcxUxr/2mN5nd/OM9uQt/v6XfCS/42Fj8829I2ClsPzsAyssqedgFgMc8qEdXqcXs3C6VlHG7tOh6xlT8ufZyKxLRAOCHbx9lvBUXEyezqMioSeXdE/9A07XfdGHv4j03MPcCfll3E9l+pirQvQKgeeIcCmbof3nSHFDEYI+RPfnbfMni3FG7nP9UfyzIk6V9u7Sk2HcsQT26lrG8tLPf/8iOVf4lvbklyYomRx5TTyTXu85vW4tOaFHuquSgCXnPnvK146YTAO5I9sU38jtG3u+ePpGLncb28wNwTx+7tICsfyE9MTfONkCpPUZKGlMctwtsmZR+u0rzKaRnLBvBb79/0gA4iGfTXS3v49sfT2qy5DqZRTUAzj6wOhCtATluOi0o+P/aY5Blcfjyx3oa288OwNkH8WB4/ZZ9ZwdAqxkdWElMzasda7dLJaXdLiO6njHXx/eioiNCNibnt0pcA8OEVXpXqpNZ1ACAfSp5Zcl209ln9r8CQHOFaWw/extA2oL8vrf/+cveCgBt+gjj0ucIv13asWE1kZR2u4zoFgCaa/rlu1sNQJLMTS3rqdRlPn3Njv7rdEZLrJNZ1ASA1IFkUWq76U4A5B2axPbLAYBVMI8dAFSbp+d5paymJRX6vGJRahZeNb9Ew1jryf703fsitAtxiTqVRWVGTSgW4YbffvtN7y0B6klsvxwAKlHdsDWCmVw11oPoUOBRtaTcNVbzdjVHZ38gvX23EoBK9Gi0yonm2v+04m6gU1lU9rfycrT5/r3GS+em2wHgWVS/+Z6nmtr2ywGA9igwa7kAcPVZ0DMkqnpeiaRYDrY+i87tErpR3aC8v4GOEXzaM0f43RMpi7dRApzIovSm05bUHfvCdtMdADQW/y2tgd1PY/vlACDeRfAAYOu15kU1k1ZjFU02UoG39lq3bpeMIx5vsuZ/I7qoSYwftFu6Tp3Moq1XIUgS+ghE+6Y7ABCXdTOR7ZcDAO0QePv9wXxPyLxdbODxD+SoKRr/1kRg44IvTfPoy7+afRYsKTqI+/ZHfdzyD+pK9MrNK+0Fop0MbQDqT9/eiqxoqNAXyZaok1m0/TJcVfCv7DfdBQAbCaZZTGH71b4OHfpGChSqqS3K6vtLEwCAuCa2aFN5X+IdAwAQ16QWpc2oJb4/AgAgrqkBOPvdZKmP0GoBgKAUAgBQ1gIAUNYCAFDWAgBQ1gIAUNYCAFDWAgBQ1gIAUNYCAFDWAgBQ1gIAUNYCAFDWAgBQ1gIAUNYCAFDWmgiAIpmmub5tKp3Vt6BAm010K3aJBAAiBGNpAgD5CcbSBADyE4ylCQDkJxhLEwDITzCWJgCQn2AsTQAgP8FYmgBAfoKxNAGA/ARjaQIA+QnG0gQA8hOMpQkA5CcYSxMAyE8wliYAkJ9gLE0AID8t31hqxzuq417bNKm6Nz+PVEIASrpXmdw2twrYqA8ATCCxpaJzH4vlG4u50nFv2ek0pfMTpQOgopv1VY3TV3T3ZHHgTRYAJNdBbDFUufYaWr6xGABW/1ksAMc93SbzgRi9vFEH/mQBQGoxw1MdHFtFz2Qs3/1rBeUAvNzeH7/6rjj/eX/P9yS+J/+/++eeVIP+uGf7SZJ9VodvK5YMgMO7P9E9weklnT/KA3+yACC1tCdk5bD+PMby3r9WWFUC0GoQ+U3Uoari/rhnbYDjvikeDvzfy+1gAlIB8PLFB3LVzZ+aWl4e+JMFAKk1VwnQceIxEm0AsjH8HYNauJIC4I4VEeRvr6O5lQgAYnZy1azW1vwvD7Q0uvOQAUB6HcQ+06dtA6QFgPkJ933u8MzHFQDsC+ZirMIx5BoSAUAeNn0AWBIDABOI7rXbyPH8XwUA8tolAKxz674LAH+ozgsArfAEV4EAwLyawlg74nz8v/E02ACg50mjwFYCiIuIzyoNAAeBYVAjGADMq/UC0By0AdC7RWesAhGVod2gAGBSzTIQJgDY7SYCQAwukUavDgDtBSJFQ70IAIIGwgDAlJpnICw9ACyNY3HFKSCVferrYhxAFA0HCfsSACCXw9z+4HwVAgBMqJm6QTsAjG4U21jqSXRmAAbkCQCSyz0QFrscZpTaAOwAQEhiACC55isBpMSnBOlNAoARDABsTfMMhE0EQCudXgD68uwyBQA2p1kGwmw3xRtc/9OTnnGi5yL6L7IVCgDkpyTGajnbIAA8YYYA0McHAICoVg1AT5y+awYAWxd/O3LygTDTjaw3xRu7m4auI63E0Tt7tWO9qrqsk2LKz4IB0IIBgI2JAkD7f5xzp5YCAA9jCVk1br/bvSmuhcsCAAAQKPGqQD1xN6jhRfab4o2swlhClm/ol5+9US4LAABAkAgA7E3EaWeE2QAwKuodZ7zwyAz5+vBG3dmr3bG4aupDrEwoisumXCAAXLZnQioASvZ6NJ1O+Ug+nX1HXkog70xcAoCN60QlgOlFwun1R3sbAJ//twBoqkCSAApA4/PE7980/nJVUACaz+2ZkBIA8gomeUWOrSpRNgxUBZ07eb27Li4BwLbFRgFuatEctmgSAHiRIP3fN2il3TiZlJncNWsD1xyAS3Lm6lq2DBoAGk9ulXEMgN3u+NUHNkVMzJqs+USCux3h5xEAbF0NA+RVXOdSCakA2OmftIat8Gt/ZC8ARA9FQZ7itApEbvHVVUH8+4oC0PxfC+/mEgCQ40pMHuOMsDmKO8oRAMhdUwKg3oII7eOXf8wA5M+b80cdgEsJQHF/pc2E5JIANHX987/ccgAOEgAeAwBkr9QAmDCo3k1vXBMAMwXymCbhrkjFxVYCkOPrdrJvOAC0WHi57ZYA1ztLXgAgP00MgKoM+eJ6AKD9n+Sg0kuA/f01mRxDW8PNCXJsSgBAXb4SVSA+N5ehxDMCAHlrCgCsIXxxvQBcFZ89sddZJQCNNzft38ea9gI1J0gvEJ8JyaWXAE0zSHSGqV4gMq5GmtAAIHMtBgBziNf4vuATIOlzWwBAxwGaihA9cdl+2+MNq+NfsrmIfAGJmo4KnP+ZhLzkr1cYlwYA8tP8AIhIbgBan0QDmzQMik4Emaz1PBGtFmncAYCclQ4A1fNpDeKMW6uOI+0m6mm3cyKi1fldcecGwHItNBIbEhEBAEDmSgNA3Q+AgwAdAOGQMo3Oyzpa8rQn80obbONrRrP6kpagrkr2lgIAiGoRAIggu5bf+gAwYukxZHYWAMx8AQC0AgDa6aQDQB+zowIA+SkZAMzbXC43GQCtnlMAAADidDoA7K7YAqDuB8CWshZjJ//oYNjzBQBQAmNp3uZz9NY7PvK8HsQKAH2nlffy25JvAdA4wL2e0r49RqDypYlfqSk1ACA/JQGgtr7F0wrUfZzLyFqQWhUFNYtSFfwd5lbwTuryKggAPPDuqom925WdhTkBAEQ1LwBGBOXFWr2mcV66qvjrg2+PRZFzF4A3b+jZTmwAAFGdCoA6CACRnn47dd9lm0Cyd9oq+koP2zupuCyKHZ39yN4VVQCIqcRklIBsJXlHBgvIGNobPlVyBAD6hjSDBQAGK7H9BysYAO3bZ49aAFRyk3ixCSQrDcp3T2JTyGNB3n1rigr6eqgBwBWbUFnTYbLrhpimOXA439GSgU2V1LbViAGgaZnw63p9cK86E5gYOwIAEQq0/yk2yBgAgM//n/XUSBTyzKbXLzeBJBNbmg/y83F/2QT86kPNJnkJAGhC1+Ktt5fbyx2bOfxye7UjUwj4PIFBABz/Tbeo+SlKAGCQAu1/ig0ydmEAWMfIzDOt9oCWYMOx3GOFbod6rzZfpJ+vaEAyS74NANFnRePvdGYNnyBDg4upksNKgFQCABPqJMujmwB4w/UA0A5spFieP6o6X1PbaWpA8jNx4d2ONAjaJYBI6E3xaAJwqaZKAoDN6iQ7xY8AwB1B3c1rPtddPvHph/OfxVZhRBSAJuCuUwV6YdN+m6LhgwHAdXE/sgq0V3uMjGgBAICBCrP/0kuAEABE/yet6gtPPe7/gzYD1IaRfG7AVQuAV94LdMVKADFH+Kr5LKdKjiwBSueKG5GJAYBB8tr/FBtkRAHQ92aPEZh9X9HNDegPUJtAlrQLQHxmJQD1fTJDgE2jZ7qiHURXxWVtAHBdqKmSowBoEhnVCwcAxqnP/ifYIMMAwB9up9fNa6PVawvMAaG/QW62yAo8NjwsPrM2AJnleF2eXRsAsAmVpHPUAIAEFlMlxwBQjav/1ABgnFLaf6g0APrCqTC7IADcjWRP8q04pm+oc7Y0ogE4uJ8soQIAI5TU/kOlvYbWE24WAEwC9Ny7igTg9WFc9b+VJwCIVIj9TzAQNgkAdTQA+vtA2txI8Q7GBACMrv638gQAcQqx/2kGwsIDSifsBaAeA0AnIRMAJ6tRAIyvfrbyBABRCrH/9N2gtjfcvGGDAZBxwi/FnqgCoLewigHgUPheTw0XABimIPtPulP8jj2iVwfATl5ERxgIW40WMBDGAXA5kyvOyQFQbp8SgGQCAFNqyoEwZfDISPxvnRgAkfYCADiIcYuqc+BJDABMoAkHwgYDoIYN0gLgoko1jcV/rkQTvQ5N3tam7ylV4hVWeeDLEwBEaILX0WM1xP+jARh0XbYTkgLfJaeZEEOnKZBXmFgNtNQOvHkCgBiln5AUKWXv6FiyGnJqAOqEANT+KXkEAL4dwfmjPPDmCQAiFT4l0tg+y9RQY2n2jo42LQCujPn/CQHwic7W/IJUeqoGAHGgpdHthgMAyRXQVzTQWLq9oyPOCYD3ipMBUNG5+qzWLycy2BsBAGBK8c6f9CVAEgBi447RaQEgVaB3TwBgfrH9oQGAlvtpACDu7qsCWRIDAJOopEuHAACZ+4kAaGyORvAidCCLQaUFYLD7twEYkvkY9WSaBgC+btf5I7pBlyG+Fppd4wCIb8aKaJsA4Lgv3j2VnTH2sql2Up/HQNi0cti/o9eHtAAoUw+MuxEAGpc+vHtiy3MZKkXn9EGby4lXIVLLaf8YDQagjnxPQY8rGRiQ+SglBYA85Mk7hva6fagAwFCltn+4xvnuZgAgL5uTG+BacikqsRoAxCq1/cMFAKjEE6gcNTEbAAxVavuHSc0uGSwRfe0A8DroAcujz6TE9g/SLikAw9OYRgN6gZyN2/g8AUCs0to/SAAgPFhsYgBgDg0FYESWAMCeGACYQ8MAGJWl4GftABz3ctneJHkCgDiltn+vtHcYRmS4JQD4OqUAYBaltn+vtBf5R0kksH4A/rin7zkAgFmU2v69UhYekV+tHH/9ANzT1SkBwDxKbf9epQJguYofCSbrE38EALMotf17BQDMYGzdvZdbrAw3j1Lbv1cAwAzGF5487gHALEpt/14BgLhgsYkBgDkUbizNwhNez6wCAPkJAGiKAIBuVI/VoWdTqP3T7RAjfH+77o8SYHtKuEMMAIgNFpsYAEiulPsDCAC2rCgAXm7vfMuex+cJAKIUYn/3DjFSAEBTDAB08ROyXbFnzZm4PAFAjILsjxIgTjEA0FV+SvJYsa/3E58nAIhRmP3H7xAjnX7rzk8U1wvE1kDHy3CzKNT+o3eIEQBIELasKADu+V0AAHNoAvvbxUyaRwEQDQBf8xOrQpxeE9jfLgDgCEZqnmQXDF4OJ8gTAMQo0P6jB8IAgCNYdfaBrT1fjtswHgAMU5j9xw+EcZsCgE6wirasXm5HFcAAYLBC7J+gG1Sz65CrXJcwErwxuQfCLHu02ZWT/wOArSlpCZDywhYqALA1jR4I08ya9soWKQCwOY0cCNPNmv7iFicAkJ/6AajHroe+HgGA/BQMwGkuZ15FAtA7yBKXJwCIVLD9fS9Ne421AwC+YCOHwNp5AoBIhdi/LIq7l3990jtETfUCoP/dumKXRRm1O1snTwAQpxD7k91jSvr0H9INugMAvmDOh8rAPAFAnALsz16Z+4IAMGRGmARg0xOBNcUBMPItuE6eACBOAfZnhcTr/9UjSwAAYA1Wjdudqp0nAIhUgP3lFqrO+hIA0BRbBcK6QHMqyP4H1v3jZqUHAHk06BLXJowD5CcAoAkA5Cc/ACe7jGUoFoCXW2yTOqfS2r8rAOAPxt4w7G7UTEco71iIQtRBXTcKAAyWy/5R8hhrBwC8wcTL5u0OtteHxtcPxQ2dtkf/qQNfngAgTi77xwkAaBo2ENYeYuFrFZw/sjtU3tTywJsnAIiTy/5x8gIwIt1VKk0JwNQ88CUJ8sCbJwCI0wlKgBHprlKJ2gBUZeP3YgzeNxgPAAZr+jbAmITXqIS9QOTmsFp/87880NLoTsoGALGauBcIAAwPVok2sAsAS2IAYA65jbUDAIODscIZVaAVCABoSgUAX48MjeAVCABoigDAt0mbaJahG3Q6TbBJYVsAYGAwuncPFQbCli8fACe8jGUociDsK+bR7br9gT2XiL8fRCfFAa9CJJfL/nECAJqGAWCv28fnCQDilNr+bQEAb7BS9eSPmhsPAIYpvf3bAgA9wcQTKFWeACBOQfYfsUEGABgZLDYxAJBeYzbIAAB9wUQ/HNoA86jf/mOWR98BgL5g5bunww02yp5N/fYfs1M8AOgLRlbaqJrnCnaJnEcB9kcJEKf4CTEvv3qk/1LkCQDiFGL/ERtkAIC+YOTxQnoiAMA8CrL/8A0yAEBvMDICU96hCjSXEtu/JQDQH6y8IU8Y7BM8l9Lav6UM/R/jANvT4IGwHQAYGyw2MQCQXsMHwgDA6GCxiQGA5BrRDQoA/MHkbAyMBM+iMPuP2Ck+R/9HCbA1jSoBprighQsAbE3DB8IAQG8wbJAxr4LsP3ggDACEBhs3Iw8AjFUy+5sCAMHB7Ks9xOcJAIYplf1NAYDgYKkmZQOAYfLan6xQQJsBrpnDDmPtAEBwMEyKn1c++5M98o77G08om7Ea5wcAwcGYfRPkCQAGyWd/1g36+kBmDUQBkKf/D+wFGvUyIgAYrAD7i4EwMncMAPQL4wAbkxwIK28AQIAAwNYk3N791nTXWNyKk17XQhULAC2Ex9WAAMAIBdhfLVQcCoCwYooLXJsiAWDL3R7GbVECAAYrsf25Mvb/6DnBsoWVJE8AEKfU9ucCAKHBUq9ODADiNNHq0AAgNJh4AmFS/DxKbX+ubL2/jm8D0AZWsm06AUCkEtufK1/3H/w69Kg3ogHAUKW2PxcASBUsNjEAMIcAgCYAkJ8AgKZYANLuVA4AYpV+p3hqv1HprVrRjWDypgkawXMpsf2JAEBEMPGmFbpB51Fq+9diDGDMRa1bsb1A7NGDgbB5lNr+dfYFAEqAVWmqEmDMNa1caAOsSunbAAAgLhh6geZV4l4gbr6RF7VmYRwgPwEATQAgP7UAyHocLA4AueJMqjwBQJSS258thQIAAoORiUjuLWr5xm2VqKJWzroqABgmv/2lYnaIWZ/vX1ykTS8CANYH5+qBO+6pwcmcPTpvTx748gQAEfLbXypqhxgAEAEAG4VxjMFU7InDblJ5ow68eQKACHntLxW3P8AaAUhLQCIAmqcN/YKV0IfzR3ngzRMARCgMAPcOMVJrByApAqlKAP7Fyxcf2KE88OYJACI0QQmwSwxA6vqJLYdlA8Bq/c3/8kBLo7tHFQCIUBgAUTvEJPf/pADYUlszAJY8ZwHg9YeiOPuGNluoRo6rnkyBAMTsEJMQgMYrE7umB4CE2UQB4J2QupYq0PFr+gvuVghA8l06kwKQ/OGspyaOOWcX8vTYTNKNBK+lEXwozn96fSi+ZM/HxqtGLfW+RsUA8Nyofg5IdBoALmrp+A4AxmaYGIDld4M2vq9XjctxD9MlKnwgbOcHgLg+U59nXygNuGAjIUua4lPNHV4d61kOzDsxAMsfCHu5LX7/dfH59/yik7xbsChFDIT1AvCsAeDzr9MAID5dtCTDD8kxNQDkfRXm9odlvgpB3ycW79Q0D8uRK10vTjHdoKH+3weAxR2H6cIKgOH0nfz0cwOyzO5t0AYA2gagztF82FoB4B4I63ZDP3sr9x0AnP6lPHEcAHoepoe3+OoAMBy+HAG4I8UTLZ022QIILwG8ADzHASCr5yO6Zi5UGvVFq7Jj+rh5FgBEA1BRAJqCYHtdQBEDYY1nu9MxATAfzy1pD39XKdDbhlZ/Ww/2Wnd1BYDxpVk+RCk7AFi/JwNggzWgOmYgzA1A8416+NO/qpLd9TPhrXVnPMzsxDQjtqo7dRuA2igGugDUAGAIAE215+wDbwNUqxkESyoNAFcdSABAvYoBUBteqUs/obWXNZe0RDQxUQAYztwCoHWRrTjDRqLzA4A9INlWQ9trAoSoHwD+8OcDAM9aEdB90KoTRnuh5ceqcq9FM5LoqDYLEKd3q/AXA1og+QFQf/q2KN7SJ3+5uU7QIPUCYHoyP+Hq7acBLdHaABjxjE/i6d2NqAVwSwW+uFBDx6HKEIDs1QdAt/OfAWBx5LoLgAUBHwDcZX3+36MOSsExiQDAxhTwypwOgIUAy+iX3gpgFSPpZ89dANr1cv0vlx+AuGFdM9nYehAA2Jqc2wNLBQCg+7U42fx/wRvH0n+ftSSexbtD5IMXAHlKHksiFA/hv7jTmAAAWev1oWdwww/AswKgdbbu1o6Ew/PvxP8yTLsTU53rNinMZu+w367xFhhjmwAUyZTyd59KVc/ohgFAmwDV9985bdSONCB011fjZ/ojvlZjaTYAWBY6AENl1KSCktooABeJtEoA+hQGQDuWDoDsGTUBUIka6VIA+JF4PlsASKIQAIyvAEDWAHQc/UJVXlrSAehK61LqAFDXHQDUp7jqfpBcAOhNEHkSAAAATbyPxw7Asw0AsxrEA+ofa7NQ0FKfCgD9ZQrzZPuoBgAAwCDADwDzbHVEa/r1s+7fPGggAIl/mPoVlvciHPkCAACgRNu2jl5Ezcn7AKhbHUzPbQKMkNbDcVIvEulDA+xPq8gBAHkDcNF5Ujv7Ylw+rsqE1rfyjxGC+p/OUitGOone1+4wsxYIAAAA9bHjxrpcPt46NM7oj/5OmWCc9Oc9SAAAAFhlBcBakTHk+9I6oFZ3AHg2u5I0r+/NfYA6Xg8AAADRQAD8MyhtoZ/NRHWvNw+Dso++lA4Atu4hAAAABjhggJ41dc+Ygwqq7zQ9AGaru+X+ACBzAMRY7gRVEP0p3zr3bL5GofWatq7AdUlhl6oAME6agQAAABBK3C9v9dE2DrUcYWt/rcbY7KmEFRi9EwQAQOYASALSD8k6AOgca2WPAYBsI9hSSVViAYCEALzcskn2H98XxeffjDfURNIBqCcEwCo/AJ13Sq1e7vsuVgAgHQCfvhZz7fkC7AuVAQDxe14BOoX/22T4sWoYaE2FToTa/s7dAAGAVAC8frxli02QlYeeXv+03BUnrABczAeAWVdqP/u7Xt5tOowQAEgFwEGstvLyazIhZcFrDpkATPNefpS8AHTbEkY7uptEHBMAIB0Av/2oOf1hNQAkmYqVUML3pZ93ATAPn9VshPhaEQBIBcDfv9Gf+k09aLFrDrUBWJxaTmx8NF3cVl8CALP1AikAyEZki112dAUAtD4+q3PPXRwsAIT/MAAwBQCf9gvuBFo+AG2ZnaLdsWJeY6pdr2arwN1zAGACAJbt/2sHoP2dLCJk08HWbyTfN2r9bACQHoDjsv1/WwCw71WgutsQeO5I+xIApAegXLb/rw8Aqv6L1Tz7uXVslA4GAQAgOQBiG77VdINuULqb2wBQPxwAJAfgsPQd6LMBQPi8+U0NAKYCYCXKAAAiX6tBCQBsDoDwneIzAcAbCgBsDYCIneK3DQBRn/sDgM0BkGyf4EwEAGIAWMGy6+l2is9DACAKgO6YyjBNB0BMCQABgM0BELNTPDQlAJWzJxwATAlAxE7x0IQAVI33V3YCAMCkAPQKAGiaCgBWFS2t27UBAACwGE0FwMstqYkerIMxAAAALEaTAfAFqf0YHXGWPsCpuhXXlu5pBQA0TQUAq/47GgHQrAIAmgBAfgIAmk5YBYIWonQVuS0o0GaxRvY1gqGlKPy2BofcWpJDI/i6QaGlaGveuiAAfANh0FK0NW9dEgBkZiD8f+HamrcuCgBo+dqatwIAKEpb81YAAEVpa94KAKAobc1bAQAUpa15KwCAoEkEAKCsBQCgrAUAoKwFAKCsBQCgrAUAoKwFAKCsBQCgrAUAoKwFAKCsBQCgrAUAoKw1PQAlW6RCzKLX9nmo6+re/OwUXRiZrERhDW5Po3SuorxxuZfv1sSWmr7pC/7yq0cjSXdgFrIvWbrP2V1IkjJk75UeOikFWYDpBABQPzzuLe4Y5vw1+UEkYOn6UQBAV9iqBWx9p77gxz1d/0aGcQfmIXuSfX1oTh2IN/clqUL2XSlZosdMKWbdhlMBYL2gYADYKiyvD47FWACApsB1a8TSZt7gFSt2ZRh3YB6yL1m5qlRvkmr9qZ4kj/s75hoBV2nRyW4ogWQAAAPiSURBVABoftDxq++K85+Js9I91+/J/+/+uSfVoD82xRz9waKANKR5/tEI3lSvzr47+0AB6ERVAJBaWBOC5v8oIrkyW7sCVy473PQHr4o76n0yjDOwCBmULHkY9icpQgYlSTwkMMmWTlkC0GoQcVZ6hU21hnkz+Ud+J//3ctt1yspoQsjgJXk+FAyAblQJAHkWkK9ZNUxEcma2cgWuXVn+muHfE5wBIML4ArOzQcmWWkr+/MnNCkmS3suwJFs6XRvghhVWxFnFtSkA7lgRQf5ar5wUFuePMgoLzkgvKQCWqAKA41cf2ONDxBORXJmtW2GrF/OHwV1fcGofGcYXuGJ9FAHJkj3OgpKkIQOSrCggYUm2dbJeIO773IOZ2ykA2BfsmpmLdvT6UNCnuBZcNNDsUfU2QEXqQDSejOTNbMWKuf2NMdICEJJsJdrA/UnKgr/vSl8f3j0tFgDphxIA1sV13wWAr+vr8smmQNSDH3QAulFlxk1d//wvtzyejNSX2VoVUwEgxWjaKlB/smyPy5Ak9d0w+66UNCsWXQUiUgDQ86zu3i0BuhKP6UpFsZcA1oxp7JdbewmwPcU0ARtX6Qke2AiuTQA8yR6YVwckedB7KPquVNaIF9sIrtsA0Iq7CYCrW1T0AlVmCcB/KG8DdKKKjFkpLqpAeqTUP3URCusEZGaotP5Iu6rAblADFU+yYrPj/iRFyL4ku98vsxu01gAQoxWkHap7NG3M28a7Kro3LmsSacHbvUBmVL0EOO553FYvkHtwbb0KGwai/lHe9QWXBWbvEBPvBfInq3rd+pJUIfuulNxn6vPLHgir9RKA1L+p+4lxAPHFgb/x0BYdDicxDABIA/v8z6xY6EaVrW86VF7KZz6P5M5s7QpbvrsU7R9vcF6xkWHcgXlIf7IHdk/4KIwvSS1k35V2v49YwHz9L8MN6sjcXu8nNExrBoDW/lh3/sSRoM1qzQDQmlSrG5O+ZCHKztBIUL5aNQAQNFYAAMpaAADKWgAAyloAAMpaAADKWgAAyloAAMpaAADKWgAAyloAAMpaAADKWgAAyloAAMpaAADKWgAAyloAAMpaAADKWgAAyloAAMpaAADKWgAAyloAAMpaAADKWgAAGiW2iSlZZfXnVS63DQCg0ZIbma5QAAAaLQAAZS0GANv/k+xge0dWaHXversoAQBotHQA6P7u5490h6I1bEQLAKDR0gG4q8V/nl1vFyQAAI2WDsC92pVwFRvRAgBotFwArGEjWgAAjZa3BFi4AAA0Wg4AVrERLQCARssBwCo2ogUA0Gi5AFjDRrQAAMpaAADKWgAAylr/D4roaeb3ftWfAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>The pristine landscape supports 436 individuals at simulation end.
Reducing habitat to 20% yields 67 individuals (single large
configuration) versus 12 individuals (several small configuration). The
spatial configuration accounts for a 55-individual difference despite
identical total habitat area (both 20%), illustrating how spatial
arrangement affects population outcomes independently of habitat
amount.</p>
<p>This example demonstrates TWoLife’s basic workflow: landscape
creation, parameter configuration, simulation execution, and result
extraction. The discrete landscape example introduced the function
structure and basic operations. We now turn to the package’s primary
innovation: modeling individual genetic variation in continuous
environmental gradients, where fitness emerges from trait-environment
matching rather than binary habitat classification.</p>
<hr />
</div>
</div>
<div id="main-analysis-individual-variation-in-heterogeneous-environments" class="section level1">
<h1>Main Analysis: Individual Variation in Heterogeneous
Environments</h1>
<div id="background-and-motivation" class="section level2">
<h2>Background and Motivation</h2>
<p>Real environments exhibit continuous variation—temperature gradients
from mountain bases to peaks, moisture clines from wet to dry regions,
resource density surfaces shaped by topography and soil <span class="citation">(Turner 1989; Wiens 1976)</span>. Real populations
contain genetically variable individuals with different optimal
conditions and tolerance ranges, as documented extensively in natural
systems <span class="citation">(Bolnick et al. 2003; Lynch and Walsh
1998)</span>. Traditional models simplify these dimensions: discrete
habitat models cannot represent gradual environmental transitions, while
models assuming genetic uniformity cannot investigate how diversity
affects population outcomes.</p>
<p>TWoLife explicitly models both dimensions—continuous environmental
gradients and individual genetic variation—enabling investigation of
questions that are challenging for traditional approaches:</p>
<ul>
<li><strong>How much genetic variation is necessary</strong> for
persistence in heterogeneous landscapes? Can populations survive with
genetic diversity in optimal values alone, or do other traits matter
more?</li>
<li><strong>Is diversity in optimal values sufficient</strong>, or must
individuals also possess tolerance ranges (niche width) enabling
survival across environmental conditions? Does</li>
</ul>
<p>tolerance trump diversity? - <strong>What roles do evolution and
behavior play</strong> relative to standing genetic variation already
present in populations? Do these mechanisms provide substantial
additional benefits, or are their effects marginal? - <strong>How do
mechanisms interact</strong>—additively (each adds independent benefit)
or synergistically (combined effects exceed simple addition)?
Understanding interaction patterns helps predict which mechanisms are
most critical.</p>
<p>We address these questions through progressive addition of genetic
and behavioral mechanisms across five scenarios. Each scenario differs
only in genetic parameters while holding all other conditions constant
(landscape, initial population size, simulation duration, master seeds),
allowing us to isolate each mechanism’s contribution to population
outcomes.</p>
</div>
<div id="generating-continuous-landscapes" class="section level2">
<h2>Generating Continuous Landscapes</h2>
<p>Setting <code>habitat_proportion = NULL</code> instructs
<code>create_fractal_landscape()</code> to generate continuous
environmental values rather than binary habitat/matrix classification.
The function produces values ranging from <code>min_value</code> to
<code>max_value</code> (here, 0.0 to 1.0) with spatial structure
controlled by <code>fractality</code>.</p>
<p>The <code>fractality</code> parameter controls spatial
autocorrelation—the statistical degree to which nearby locations have
similar values. This determines landscape patchiness:</p>
<ul>
<li><p><strong>fractality near 0</strong> (e.g., 0.1): High local
variation with low autocorrelation. Adjacent cells often have very
different values, creating a fine-grained, highly heterogeneous mosaic.
This represents environments with high small-scale variation (e.g.,
rocky outcrops with scattered vegetation).</p></li>
<li><p><strong>fractality near 1</strong> (e.g., 0.9): Low local
variation with high autocorrelation. Adjacent cells have very similar
values, creating large homogeneous regions with smooth gradients. This
represents environments with broad-scale patterns (e.g., elevation
gradients with gradually changing temperatures).</p></li>
<li><p><strong>fractality = 0.5</strong>: Intermediate spatial structure
with balanced autocorrelation. Creates realistic landscapes with
moderate patchiness—regions of similar values cluster together but sharp
transitions also occur. This intermediate value is appropriate for many
natural systems.</p></li>
</ul>
<p>We generate a continuous landscape for our main analysis:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">200</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>continuous_landscape <span class="ot">&lt;-</span> <span class="fu">create_fractal_landscape</span>(</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="at">cells_per_row =</span> <span class="dv">15</span>,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="at">fractality =</span> <span class="fl">0.5</span>,              <span class="co"># Balanced spatial autocorrelation</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="at">habitat_proportion =</span> <span class="cn">NULL</span>,      <span class="co"># NULL = continuous values (not binary 0/1)</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="at">min_value =</span> <span class="fl">0.0</span>,               <span class="co"># Minimum environmental value</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="at">max_value =</span> <span class="fl">1.0</span>                <span class="co"># Maximum environmental value</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>)</span></code></pre></div>
<p>The resulting landscape contains 225 cells (15×15) with environmental
values ranging continuously from 0.0 to 1.0. These values represent
environmental conditions (temperature, moisture, resource availability,
or any relevant gradient) but carry no inherent “quality”—a value of 0.3
is not intrinsically better or worse than 0.7. Fitness depends on
phenotype-environment matching: an individual with genotype_mean=0.3
performs best at 0.3, while an individual with genotype_mean=0.7
performs best at 0.7.</p>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The visualization uses a terrain color scheme where cooler colors
(blues, greens) represent low environmental values and warmer colors
(yellows, reds) represent high values. Observe the intermediate-scale
patchiness created by fractality=0.5—some clustering of similar values
occurs, but substantial variation exists across the landscape.</p>
<p>This phenotype-environment matching framework distinguishes TWoLife
from models that pre-assign habitat quality based solely on location
type. Here, fitness emerges dynamically from the interaction between
individual traits and local conditions, allowing investigation of
adaptive matching, local adaptation trajectories, and niche evolution
without assuming fitness landscapes a priori.</p>
</div>
<div id="experimental-design-progressive-mechanisms" class="section level2">
<h2>Experimental Design: Progressive Mechanisms</h2>
<p>We implement five scenarios that differ only in genetic parameters,
with all other conditions held constant. This factorial design allows us
to isolate each mechanism’s contribution to population outcomes:</p>
<table>
<colgroup>
<col width="12%" />
<col width="23%" />
<col width="16%" />
<col width="14%" />
<col width="12%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th>Scenario</th>
<th>Genetic Diversity</th>
<th>Niche Width</th>
<th>Evolution</th>
<th>Behavior</th>
<th>Configuration</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1. Uniform specialists</td>
<td>No (all genotype=1.0)</td>
<td>No (sds=0)</td>
<td>No</td>
<td>No</td>
<td>Default parameters</td>
</tr>
<tr class="even">
<td>2. Variable specialists</td>
<td>Yes (genotypes 0.3-0.7)</td>
<td>No (sds=0)</td>
<td>No</td>
<td>No</td>
<td>genotype_means only</td>
</tr>
<tr class="odd">
<td>3. Generalists</td>
<td>Yes</td>
<td><strong>Yes (sds=0.15)</strong></td>
<td>No</td>
<td>No</td>
<td>Add genotype_sds</td>
</tr>
<tr class="even">
<td>4. Evolution</td>
<td>Yes</td>
<td>Yes</td>
<td><strong>Yes</strong> (mutation + plasticity)</td>
<td>No</td>
<td>Add mutation, plasticity</td>
</tr>
<tr class="odd">
<td>5. Habitat selection</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td><strong>Yes</strong> (sampling=100)</td>
<td>Add sampling_points</td>
</tr>
</tbody>
</table>
<p>All scenarios use identical conditions except genetic parameters: -
Same landscape (continuous_landscape generated above) - Same initial
population size (40 individuals) - Same simulation duration (250
demographic events) - Different but comparable master seeds (45-49)</p>
<p>The progressive design means each scenario builds on the previous one
by adding a single mechanism. This allows us to attribute population
changes to specific mechanisms and test whether mechanisms interact
additively or synergistically.</p>
<p>Before running scenarios, we pre-generate genotype_mean values for
Scenarios 2-5 to ensure comparability. Using the same genotype
distribution across scenarios isolates the effects of tolerance,
evolution, and behavior without confounding by different starting
genetic compositions:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Pre-generate genotypes for Scenarios 2-5</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co"># Uniform distribution from 0.3 to 0.7 captures environmental range</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">300</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>initial_genotypes <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">40</span>, <span class="fl">0.3</span>, <span class="fl">0.7</span>)</span></code></pre></div>
</div>
<div id="scenario-1-uniform-perfect-specialists" class="section level2">
<h2>Scenario 1: Uniform Perfect Specialists</h2>
<p><strong>Configuration:</strong> All individuals genetically identical
(genotype_mean=1.0, the default value) with zero tolerance
(genotype_sd=0, also default). This represents a population of perfect
specialists requiring exact environmental match for survival. Since
default parameters apply when genetic_params is omitted, we simply
exclude that argument.</p>
<p><strong>Hypothesis:</strong> The population will rapidly collapse
because the landscape lacks environmental values of exactly 1.0, and
zero tolerance means individuals cannot survive any environmental
mismatch, however slight. Even if a cell has value 0.999, individuals
with genotype 1.0 and tolerance 0 will die because the Gaussian fitness
function yields near-zero fitness for any mismatch when tolerance
approaches zero.</p>
<p><strong>Rationale:</strong> This extreme scenario establishes a
baseline showing that genetic uniformity combined with perfect
specialization is incompatible with environmental heterogeneity in
continuous landscapes. It demonstrates the necessity of either genetic
diversity or tolerance for persistence.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>sim_s1 <span class="ot">&lt;-</span> <span class="fu">twolife_simulation</span>(</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="at">landscape_params =</span> <span class="fu">list</span>(<span class="at">habitat =</span> continuous_landscape),</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="at">individual_params =</span> <span class="fu">list</span>(<span class="at">initial_population_size =</span> <span class="dv">40</span>),</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="co"># Omit genetic_params to use defaults: all genotype=1.0, sd=0</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="at">simulation_params =</span> <span class="fu">list</span>(<span class="at">max_events =</span> <span class="dv">250</span>),</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="at">master_seed =</span> <span class="dv">45</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>(pop_s1 <span class="ot">&lt;-</span> sim_s1<span class="sc">$</span>summary<span class="sc">$</span>final_population_size)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p><strong>Result:</strong> N = 0 (extinct, as hypothesized). The
landscape’s environmental values range from 0.00 to 1.00 with mean 0.57.
No cells contain the value 1.0 required by the genetically uniform
population. Even the maximum value (1.00) fails to support individuals
with genotype=1.0 and tolerance=0, because the fitness function yields
exp(-(1.0-max)²/(2×0²)) which approaches 0 for any mismatch.</p>
<p><strong>Interpretation:</strong> This demonstrates that genetic
uniformity combined with perfect specialization is incompatible with
environmental heterogeneity in continuous landscapes. In nature, such
populations would face extinction unless environments were
unrealistically homogeneous. The result establishes that some form of
physiological flexibility—either genetic diversity in optimal values or
tolerance enabling survival across conditions—is necessary for
persistence in heterogeneous environments.</p>
</div>
<div id="scenario-2-variable-specialists" class="section level2">
<h2>Scenario 2: Variable Specialists</h2>
<p><strong>Configuration:</strong> Different genotype_mean values
uniformly distributed from 0.3 to 0.7 (capturing most of the landscape’s
environmental range), but tolerance remains zero (genotype_sd=0). This
represents genetic diversity in optimal values without physiological
flexibility—40 different genotypes but all are perfect specialists.</p>
<p><strong>Hypothesis:</strong> Despite substantial genetic diversity
spanning much of the environmental range, the population will still
collapse. The issue is that continuous landscapes rarely provide exact
matches to specific genotype values. The probability of a cell having
value exactly 0.4573 (for instance) is essentially zero in continuous
space. Without tolerance, individuals require exact matches that do not
exist.</p>
<p><strong>Rationale:</strong> This scenario tests whether genetic
diversity alone suffices for persistence, or whether tolerance (niche
width) is also necessary. Many classical population genetic models
assume individuals differ in optimal values but do not explicitly model
tolerance ranges. This scenario tests that assumption’s adequacy for
spatially heterogeneous environments.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>sim_s2 <span class="ot">&lt;-</span> <span class="fu">twolife_simulation</span>(</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="at">landscape_params =</span> <span class="fu">list</span>(<span class="at">habitat =</span> continuous_landscape),</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="at">individual_params =</span> <span class="fu">list</span>(<span class="at">initial_population_size =</span> <span class="dv">40</span>),</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="at">genetic_params =</span> <span class="fu">list</span>(</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>    <span class="at">genotype_means =</span> initial_genotypes  <span class="co"># 40 different optimum values 0.3-0.7</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>    <span class="co"># genotype_sds defaults to 0 when not specified</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  ),</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  <span class="at">simulation_params =</span> <span class="fu">list</span>(<span class="at">max_events =</span> <span class="dv">250</span>),</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  <span class="at">master_seed =</span> <span class="dv">46</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>)</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>(pop_s2 <span class="ot">&lt;-</span> sim_s2<span class="sc">$</span>summary<span class="sc">$</span>final_population_size)</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p><strong>Result:</strong> N = 0 (extinct, confirming hypothesis). Even
with 40 different genotypes distributed across the environmental range
(0.3-0.7), the probability of exact phenotype-environment matches
remains negligible in continuous space. Each individual requires a cell
with environmental value precisely matching its genotype_mean. While the
landscape contains values throughout the 0-1 range, the probability that
any specific cell has value exactly 0.4573, 0.5128, etc. (the 40
genotype values) is effectively zero.</p>
<p><strong>Interpretation:</strong> Genetic diversity in optimal values
alone is insufficient for persistence in continuous heterogeneous
landscapes. Individuals also need tolerance ranges (niche width)
enabling survival across a spectrum of conditions near their optimum.
This result has important implications for conservation: maintaining
genetic diversity may be necessary but is not sufficient—populations
also need physiological flexibility to cope with environmental
variation. The finding challenges models that represent individual
variation solely through optimal values without explicit tolerance
parameters.</p>
</div>
<div id="scenario-3-generalists-niche-width" class="section level2">
<h2>Scenario 3: Generalists (Niche Width)</h2>
<p><strong>Configuration:</strong> Same genotype diversity as Scenario 2
(genotype_means from 0.3-0.7), but now add genotype_sd=0.15 for all
individuals. This creates tolerance ranges of approximately ±2σ = ±0.30
around each optimal value, converting narrow specialists into
generalists capable of surviving across a range of conditions.</p>
<p><strong>Hypothesis:</strong> Niche width will enable persistence by
allowing individuals to survive across a spectrum of conditions rather
than requiring exact matches. An individual with genotype_mean=0.5 and
genotype_sd=0.15 can now survive reasonably well from approximately 0.2
to 0.8 (within ±2σ), dramatically expanding the portion of landscape
that is effectively habitable.</p>
<p><strong>Rationale:</strong> This scenario tests whether tolerance
(niche width) is the critical mechanism enabling persistence in
heterogeneous landscapes. The hypothesis predicts that tolerance is both
necessary (Scenarios 1-2 failed without it) and sufficient (this
scenario should succeed with it alone, without requiring evolution or
behavior). If confirmed, this would establish tolerance as the
fundamental determinant of persistence, with other mechanisms providing
secondary enhancements.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>sim_s3 <span class="ot">&lt;-</span> <span class="fu">twolife_simulation</span>(</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="at">landscape_params =</span> <span class="fu">list</span>(<span class="at">habitat =</span> continuous_landscape),</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="at">individual_params =</span> <span class="fu">list</span>(<span class="at">initial_population_size =</span> <span class="dv">40</span>),</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="at">genetic_params =</span> <span class="fu">list</span>(</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    <span class="at">genotype_means =</span> initial_genotypes,      <span class="co"># Same genetic diversity as S2</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>    <span class="at">genotype_sds =</span> <span class="fu">rep</span>(<span class="fl">0.15</span>, <span class="dv">40</span>)            <span class="co"># Add tolerance: key difference from S2</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  ),</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  <span class="at">simulation_params =</span> <span class="fu">list</span>(<span class="at">max_events =</span> <span class="dv">250</span>),</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>  <span class="at">master_seed =</span> <span class="dv">47</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>)</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>(pop_s3 <span class="ot">&lt;-</span> sim_s3<span class="sc">$</span>summary<span class="sc">$</span>final_population_size)</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt; [1] 470</span></span></code></pre></div>
<p><strong>Result:</strong> N = 470 (1175.0% survival). This marks the
<strong>critical transition</strong> from extinction (Scenarios 1-2:
N=0) to viability (Scenario 3: N&gt;0). The addition of tolerance alone,
without evolution or behavior, enables population persistence.</p>
<p>We can examine survivor trait distributions to verify that tolerance
enables persistence by expanding effective habitat:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Examine survivor trait distribution</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="cf">if</span> (pop_s3 <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  survivor_summary <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>    <span class="at">Mean_genotype =</span> <span class="fu">mean</span>(sim_s3<span class="sc">$</span>survivors<span class="sc">$</span>genotype),</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>    <span class="at">SD_genotype =</span> <span class="fu">sd</span>(sim_s3<span class="sc">$</span>survivors<span class="sc">$</span>genotype),</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>    <span class="at">Range =</span> <span class="fu">paste0</span>(<span class="st">&quot;[&quot;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>, <span class="fu">min</span>(sim_s3<span class="sc">$</span>survivors<span class="sc">$</span>genotype)), </span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>                   <span class="st">&quot;, &quot;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>, <span class="fu">max</span>(sim_s3<span class="sc">$</span>survivors<span class="sc">$</span>genotype)), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  )</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>  survivor_summary</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>}</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt;        Mean_genotype          SD_genotype                Range </span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt;  &quot;0.585847073544332&quot; &quot;0.0228757001168493&quot;       &quot;[0.56, 0.61]&quot;</span></span></code></pre></div>
<p>The survivor genotype distribution shows which optimal values were
favored by selection. If survivors span most of the initial genotype
range (0.3-0.7), this indicates that diverse optimal values can persist
when coupled with tolerance. Narrow survivor distributions would suggest
strong environmental filtering even with tolerance.</p>
<p><strong>Mechanism explanation:</strong> An individual with
genotype_mean=0.5 and genotype_sd=0.15 achieves fitness using the
Gaussian formula: fitness = exp(-(phenotype-environment)²/(2×0.15²)).
When this individual occupies a cell with environment=0.5, fitness=1.0
(perfect match). At environment=0.3 or 0.7 (±0.2 units away), fitness
remains ≈0.45—reduced but sufficient for survival. At environment=0.2 or
0.8 (±0.3 units), fitness ≈0.14—marginal but possible. This tolerance
range transforms previously unusable portions of the landscape into
accessible habitat. Previously, only exact matches (probability ≈0)
enabled survival; now, a continuous range of conditions (±0.3 units ≈
60% of landscape range) supports reasonable fitness.</p>
<p><strong>Interpretation:</strong> Niche width (tolerance) is the key
mechanism enabling persistence in heterogeneous environments. This
single parameter—genotype_sd—determines the breadth of conditions an
individual can survive, directly controlling how much of a heterogeneous
landscape is effectively habitable. The transition from S2 (extinct) to
S3 (viable) demonstrates that tolerance is both necessary (required for
any persistence) and sufficient (enables persistence without additional
mechanisms). This finding has important ecological implications:
tolerance may be more critical than genetic diversity in optimal values
for population persistence in variable environments.</p>
</div>
<div id="scenario-4-evolution-mutation-plasticity" class="section level2">
<h2>Scenario 4: Evolution (Mutation + Plasticity)</h2>
<p><strong>Configuration:</strong> Same as Scenario 3 (genotype
diversity + tolerance), but add evolutionary mechanisms:
mutation_rate=0.05 (5% probability of genetic change per reproduction
event) and plasticity=0.02 (phenotypes can shift 2% per timestep toward
local environmental values). These parameters enable both
across-generation evolution (via mutation and selection) and
within-generation acclimation (via plasticity).</p>
<p><strong>Hypothesis:</strong> Evolutionary mechanisms will enhance
persistence through dual-timescale adaptation. Plasticity provides rapid
within-generation adjustment to local conditions, improving fitness
immediately upon dispersal to new environments. Mutation enables gradual
across-generation evolution as beneficial genotypes (those matching
common environmental conditions) increase in frequency through natural
selection. The combined effect should increase population size relative
to Scenario 3.</p>
<p><strong>Rationale:</strong> This scenario tests whether evolution
provides substantial additional benefit beyond standing genetic
variation and tolerance. If the population increase is large, evolution
is important. If the increase is small or absent, standing variation and
tolerance alone may suffice. The dual-timescale mechanisms (plasticity
for immediate adjustment, mutation for long-term evolution) are
biologically realistic and commonly invoked in adaptation theory.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>sim_s4 <span class="ot">&lt;-</span> <span class="fu">twolife_simulation</span>(</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="at">landscape_params =</span> <span class="fu">list</span>(<span class="at">habitat =</span> continuous_landscape),</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="at">individual_params =</span> <span class="fu">list</span>(<span class="at">initial_population_size =</span> <span class="dv">40</span>),</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="at">genetic_params =</span> <span class="fu">list</span>(</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>    <span class="at">genotype_means =</span> initial_genotypes,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>    <span class="at">genotype_sds =</span> <span class="fu">rep</span>(<span class="fl">0.15</span>, <span class="dv">40</span>),</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>    <span class="at">mutation_rates =</span> <span class="fu">rep</span>(<span class="fl">0.05</span>, <span class="dv">40</span>),   <span class="co"># Enable evolution across generations</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>    <span class="at">plasticities =</span> <span class="fu">rep</span>(<span class="fl">0.02</span>, <span class="dv">40</span>)      <span class="co"># Enable plasticity within generations</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>  ),</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>  <span class="at">simulation_params =</span> <span class="fu">list</span>(<span class="at">max_events =</span> <span class="dv">250</span>),</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>  <span class="at">master_seed =</span> <span class="dv">48</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>)</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>(pop_s4 <span class="ot">&lt;-</span> sim_s4<span class="sc">$</span>summary<span class="sc">$</span>final_population_size)</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; [1] 244</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>(delta_evolution <span class="ot">&lt;-</span> pop_s4 <span class="sc">-</span> pop_s3)</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; [1] -226</span></span></code></pre></div>
<p><strong>Result:</strong> N = 244 (change: -226 individuals from
Scenario 3). Evolution resulted in 226 fewer survivors than tolerance
alone, likely due to demographic stochasticity rather than mechanism
effects—this could represent chance variation given the short simulation
duration.</p>
<p><strong>Mechanism explanation—Plasticity:</strong> When an individual
with plasticity=0.02 and genotype_mean=0.4 moves to a location with
environment=0.6, its phenotype (initially equal to genotype_mean=0.4)
begins shifting toward 0.6 at rate 0.02 per timestep. After one
timestep: phenotype = 0.4 + 0.02×(0.6-0.4) = 0.404. After 10 timesteps:
phenotype ≈ 0.438 (shifted 38% of the distance). This gradual adjustment
improves fitness in sub-optimal locations without requiring genetic
change, providing within-generation acclimation.</p>
<p><strong>Mechanism explanation—Mutation:</strong> When an individual
with mutation_rate=0.05 reproduces, offspring have 5% probability of
receiving a mutated genotype_mean rather than exact parental value. If
mutation occurs, offspring genotype_mean is drawn from a distribution
centered on the parent value. Over multiple generations, beneficial
mutations (those improving fitness given landscape conditions) increase
in frequency through differential reproduction, causing gradual
evolution of population mean genotype_mean toward prevalent
environmental conditions.</p>
<p><strong>Interpretation:</strong> Evolution and plasticity appear to
have limited additional effect beyond standing tolerance in this short
simulation, suggesting tolerance is the dominant mechanism. Longer
simulations might reveal greater evolutionary effects. The key insight
is that evolution operates on top of—but cannot compensate for lack
of—basic physiological flexibility (tolerance). Populations need
tolerance first, then evolution can optimize trait distributions. This
hierarchical importance has implications for conservation: protecting
tolerant genotypes may be more critical than preserving
evolvability.</p>
</div>
<div id="scenario-5-habitat-selection-behavioral-optimization" class="section level2">
<h2>Scenario 5: Habitat Selection (Behavioral Optimization)</h2>
<p><strong>Configuration:</strong> Same as Scenario 4 (diversity +
tolerance + evolution), but add sampling_points=100. Individuals now
evaluate 100 potential dispersal locations before deciding where to
move, selecting using softmax weighting by expected fitness at each
location. This represents active habitat selection rather than random
dispersal.</p>
<p><strong>Hypothesis:</strong> Behavioral habitat selection will
optimize spatial distribution and amplify the benefits of genetic
variation by enabling individuals to actively seek conditions matching
their phenotypes. Individuals with genotype_mean=0.3 should
preferentially settle in low-value regions, while those with
genotype_mean=0.7 should seek high-value regions. This active sorting
should improve average fitness and increase population size relative to
Scenario 4’s random dispersal.</p>
<p><strong>Rationale:</strong> This scenario tests whether behavior
provides substantial additional benefit beyond genetics, tolerance, and
evolution. Habitat selection is widespread in nature and has been
hypothesized to facilitate local adaptation by ensuring individuals
occupy suitable environments. If the population increase is substantial,
behavior is an important mechanism deserving explicit modeling. If the
increase is modest, passive processes (dispersal, selection on
tolerance) may suffice.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>sim_s5 <span class="ot">&lt;-</span> <span class="fu">twolife_simulation</span>(</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="at">landscape_params =</span> <span class="fu">list</span>(<span class="at">habitat =</span> continuous_landscape),</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="at">individual_params =</span> <span class="fu">list</span>(<span class="at">initial_population_size =</span> <span class="dv">40</span>),</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="at">genetic_params =</span> <span class="fu">list</span>(</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    <span class="at">genotype_means =</span> initial_genotypes,</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>    <span class="at">genotype_sds =</span> <span class="fu">rep</span>(<span class="fl">0.15</span>, <span class="dv">40</span>),</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>    <span class="at">mutation_rates =</span> <span class="fu">rep</span>(<span class="fl">0.05</span>, <span class="dv">40</span>),</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>    <span class="at">plasticities =</span> <span class="fu">rep</span>(<span class="fl">0.02</span>, <span class="dv">40</span>),</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>    <span class="at">sampling_points =</span> <span class="fu">rep</span>(<span class="dv">100</span>, <span class="dv">40</span>)  <span class="co"># Enable habitat selection</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>  ),</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>  <span class="at">simulation_params =</span> <span class="fu">list</span>(<span class="at">max_events =</span> <span class="dv">250</span>),</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>  <span class="at">master_seed =</span> <span class="dv">49</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>)</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>(pop_s5 <span class="ot">&lt;-</span> sim_s5<span class="sc">$</span>summary<span class="sc">$</span>final_population_size)</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="co">#&gt; [1] 338</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>(delta_behavior <span class="ot">&lt;-</span> pop_s5 <span class="sc">-</span> pop_s4)</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co">#&gt; [1] 94</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>(cumulative_gain <span class="ot">&lt;-</span> pop_s5 <span class="sc">-</span> pop_s2)</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="co">#&gt; [1] 338</span></span></code></pre></div>
<p><strong>Result:</strong> N = 338 (change: +94 individuals from
Scenario 4). Cumulative improvement from the extinct baseline (Scenario
2, variable specialists without tolerance): <strong>338 individuals
gained</strong> through sequential addition of tolerance (S2→S3),
evolution (S3→S4), and behavior (S4→S5).</p>
<p><strong>Mechanism explanation:</strong> With sampling_points=100,
each dispersal event involves evaluating 100 randomly chosen locations.
For each location j, expected fitness F_j is calculated using the
individual’s phenotype and that location’s environmental value. The
individual selects among locations using softmax probability: P_j =
exp(F_j/τ) / Σ_k exp(F_k/τ), where τ is a temperature parameter
controlling selection strength. This means individuals strongly prefer
high-fitness locations but retain some probability of choosing
sub-optimal sites, preventing unrealistic determinism. The result is
that individuals with genotype_mean=0.3 tend to accumulate in low-value
regions (better matches), while those with genotype_mean=0.7 accumulate
in high-value regions.</p>
<p><strong>Interpretation:</strong> Habitat selection provides
additional enhancement (94 individuals, 38.5% increase) by enabling
active spatial sorting. However, like evolution, behavior operates on
top of—rather than replacing—fundamental tolerance. The cumulative gain
analysis reveals the relative importance of mechanisms: tolerance
(S2→S3) accounts for 470 individuals (the transition from extinction to
viability), while evolution and behavior together add -132
individuals—substantial but secondary to tolerance’s enabling
effect.</p>
</div>
<div id="comparative-analysis" class="section level2">
<h2>Comparative Analysis</h2>
<p>The table below summarizes population outcomes across all five
scenarios. The “Change” column shows each mechanism’s incremental
contribution, revealing relative importance:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Summary table showing progressive mechanism effects</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>results_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="at">Scenario =</span> <span class="fu">c</span>(<span class="st">&quot;S1: Uniform&quot;</span>, <span class="st">&quot;S2: Diversity&quot;</span>, <span class="st">&quot;S3: Tolerance&quot;</span>, </span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>               <span class="st">&quot;S4: Evolution&quot;</span>, <span class="st">&quot;S5: Behavior&quot;</span>),</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="at">Final_N =</span> <span class="fu">c</span>(pop_s1, pop_s2, pop_s3, pop_s4, pop_s5),</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="at">Change =</span> <span class="fu">c</span>(<span class="st">&quot;—&quot;</span>, </span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>             <span class="fu">sprintf</span>(<span class="st">&quot;%+d&quot;</span>, pop_s2 <span class="sc">-</span> pop_s1),</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>             <span class="fu">sprintf</span>(<span class="st">&quot;%+d&quot;</span>, pop_s3 <span class="sc">-</span> pop_s2),</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>             <span class="fu">sprintf</span>(<span class="st">&quot;%+d&quot;</span>, pop_s4 <span class="sc">-</span> pop_s3),</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>             <span class="fu">sprintf</span>(<span class="st">&quot;%+d&quot;</span>, pop_s5 <span class="sc">-</span> pop_s4)),</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  <span class="at">Mechanism_Added =</span> <span class="fu">c</span>(<span class="st">&quot;None (baseline)&quot;</span>, </span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>                      <span class="st">&quot;Genetic diversity in optima&quot;</span>,</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>                      <span class="st">&quot;Tolerance (niche width)&quot;</span>,</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>                      <span class="st">&quot;Mutation + plasticity&quot;</span>,</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>                      <span class="st">&quot;Habitat selection&quot;</span>)</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>)</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>results_summary</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt;        Scenario Final_N Change             Mechanism_Added</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt; 1   S1: Uniform       0      —             None (baseline)</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt; 2 S2: Diversity       0     +0 Genetic diversity in optima</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt; 3 S3: Tolerance     470   +470     Tolerance (niche width)</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt; 4 S4: Evolution     244   -226       Mutation + plasticity</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt; 5  S5: Behavior     338    +94           Habitat selection</span></span></code></pre></div>
<p>The S2→S3 transition (adding tolerance) accounts for 470
individuals—the largest and most critical contribution representing the
fundamental shift from extinction to viability. This single parameter
change (adding genotype_sd=0.15) enables population persistence.
Subsequent mechanisms provide incremental effects: evolution adds -226
individuals (-48.1% increase over tolerance alone), and behavior adds 94
individuals (38.5% further increase).</p>
<p>The figure below shows population trajectories over time (left panel)
and final population sizes (right panel) across scenarios. Note that
Scenarios 1-2 (red bars, extinct) differ fundamentally from Scenarios
3-5 (yellow-green gradient, viable). The trajectory panel reveals
temporal dynamics: S3 shows initial decline then stabilization, while
S4-S5 show enhanced dynamics from evolutionary and behavioral
mechanisms:</p>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="verifying-phenotype-environment-matching" class="section level2">
<h2>Verifying Phenotype-Environment Matching</h2>
<p>The <code>check_habitat_match()</code> function provides diagnostic
visualization to verify that survivors occupy environmentally suitable
locations. Each panel shows: (left) the landscape with survivor
positions colored by their phenotypes, and (right) a histogram showing
the distribution of local environmental values where survivors are
found. Effective phenotype-environment matching is indicated when
individuals with similar phenotypes cluster spatially in regions with
similar environmental values, and when the histogram of occupied
environmental values matches the distribution of phenotypes.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Scenario 3: Tolerance only</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co"># Expect moderate phenotype-environment matching from passive processes</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="cf">if</span> (pop_s3 <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="fu">check_habitat_match</span>(sim_s3, </span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>                           <span class="at">color_by =</span> <span class="st">&quot;phenotype&quot;</span>, </span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>                           <span class="at">landscape_colors =</span> <span class="st">&quot;terrain&quot;</span>,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>                           <span class="at">point_size =</span> <span class="fl">1.5</span>,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>                           <span class="at">show_legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>}</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; Habitat Matching Statistics (colored by Phenotype ):</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; ----------------------------</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; Number of survivors: 470 </span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; Phenotype distribution:</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt;   Mean: 0.586 </span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt;   Range: 0.561 to 0.609 </span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; Habitat value at survivor locations:</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt;   Mean: 0.588 </span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt;   Range: 0.248 to 0.962 </span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; Phenotype-Habitat correlation:0.053</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In Scenario 3 (tolerance only, no habitat selection), survivors
should show moderate spatial sorting. Individuals with low phenotypes
(cool colors—blue/green) should tend to occupy low-value regions (also
cool colors on landscape), while high phenotypes (warm
colors—yellow/red) should occupy high-value regions. This matching
arises passively from differential survival: individuals experience
higher fitness when phenotype-environment mismatch is small, so natural
selection favors occupation of matching environments even without active
habitat selection.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Scenario 4: Evolution added</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co"># Expect similar or slightly improved matching from evolutionary optimization</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="cf">if</span> (pop_s4 <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  <span class="fu">check_habitat_match</span>(sim_s4, </span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>                           <span class="at">color_by =</span> <span class="st">&quot;phenotype&quot;</span>, </span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>                           <span class="at">landscape_colors =</span> <span class="st">&quot;terrain&quot;</span>,</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>                           <span class="at">point_size =</span> <span class="fl">1.5</span>,</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>                           <span class="at">show_legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>}</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt; Habitat Matching Statistics (colored by Phenotype ):</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt; ----------------------------</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt; Number of survivors: 244 </span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt; Phenotype distribution:</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co">#&gt;   Mean: 0.526 </span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co">#&gt;   Range: 0.027 to 0.862 </span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="co">#&gt; Habitat value at survivor locations:</span></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="co">#&gt;   Mean: 0.538 </span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a><span class="co">#&gt;   Range: 0.21 to 0.919 </span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a><span class="co">#&gt; Phenotype-Habitat correlation:0.459</span></span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a><span class="co">#&gt;   -&gt; Positive match: individuals in habitat matching their phenotype</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwAAAAGACAMAAAAtcPVNAAACE1BMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAOv8AZpAAZrYAZv8ApgADpwAKqgAOqwAdsAAhsQAwtwA6AAA6ADo6AGY6AP86OgA6Ojo6OmY6OpA6Ov86ZmY6ZpA6ZrY6kLY6kNs6kP9BvABFvQBKvgBOwABXwgBgxQBlxgBmAABmADpmAGZmAP9mOgBmOjpmOpBmZjpmZmZmZv9mkGZmkJBmkLZmkNtmkP9mtrZmtttmtv9qyABvyQB0ygB9zQCCzgCHzwCN0QCQOgCQOjqQOv+QZgCQZjqQkDqQkGaQkLaQkP+QtpCQttuQtv+Q29uQ2/+S0gCX0wCc1QCi1gCn1wCs2ACy2gC2ZgC2Zjq2ZpC2Zv+2kDq2kGa225C227a229u22/+2/7a2/9u2//+32wC93ADD3gDI3wDMzMzO4ADU4gDa4wDbkDrbkGbbkP/btmbbtpDb27bb29vb2//b/7bb/9vb///g5ADm2Q7m3Qnm4QXm5gDnyyDnzxzn0hfn1hLowDPowy7oxiroyCXpuEbpukHpvD3pvjjqs1nqtFTqtVDqt0vrsWfrsl7rsmPssXHssXbssXvssoDtsoXts4nttI7ttZPut5juuZ3uuqLuvKfvv6zvwbHvxLbvxrvwycDwzcXw0Mrw1M/x19Tx29nx397x5OPy8vL/AAD/tmb/trb/tv//25D/27b/2////7b//9v///9xZOZnAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2diZ8cx3XfB1wB9iJREq0tyWZEL8ME8cqgEieRbU7okFwjkkKLWZgEMQydmLQXAlrQBJLiZCWABCCABAlTkWBaDE3FdpQ7M8Eiu/Unput+r6/prqq+pt7v81lgpqeO7lfv23V29YSRSBFr0vcJkEh9igAgRS0CgBS1CABS1CIASFGLACBFLQKAFLUIAFLUIgBIUYsAIEWtEQNwvDs5dSD/30Q/zCaP7eMwx/9qPxPXHJhNJjIZ8WmzLJjUfHJiL5N71empwIdbKKiIiaKDE7b5rszA6tGX0lP/pTdt+pv5j+mXf/25yeTEF97MRS869bpZj15RAPDo6YyDgQPc7YWjHu3kAMjFawJAGniyjT+AmJUAiHzre+FyazLRVyGz05cBPvL0ZLDpygQJgFGoDgCrD3AAhH8ebuUAyMUDAKxWSpQ+P5RM3r2y+eTyrRRPf89WM/w61GWAjwIGqSZpr7/WB4DvPM3bAdw/U//5g7RRwCt7EWamit2EmAE/SD9/XqQjHAQlZIJ9O207fOoZJgD4l69NJif3dO7gQHpIfLLeO5O4pG6IkoU1wPFrW5OTX5dRMvn+kbq876SX8qkvH+DcIUVHX9raZIYacaPf1AYCAKRnk17Co/TYVAdOEd0Wyf7u05PHnpbxl+nvymrme/YsePA32b+t26IatNYGgOXEtANm9lYHAbAhMgD87a302PHuY1+d4IR0MJXetr2LmhaKPnBiT7cxTnzOALCUVctcuJBNFgCgmyU8SjZfBYDKAXzUmRVXI/PJyaeV14OP9vcUx+0sACKDb0tPn+mTW9rvBWdx6mC+HvXJuAHQ2uRffv7AlO7k1Jvs2+pwWmgz5bEgBGwCPbObHjvcOvX7+YR4sNQTfuXg0Q7/PBcpiza9AeCkOsDDbR4cz6xPHO2ofHHuAAAZ5TUeJZevDCFbNnONn8ksB4BqAi3TWkI1CcFHrjTeiS+/Ya4aAZBe1L+T9xFxSJ+h/p49Cx48/WHzgBsZdm9GqHUBgOu7fJhj0zQ9ZtKtNAA4BARgOhM3vO15PiEeTP47/8Ib+mZunUQdkI0c41QobeXTIFkAQCYKyhed+kzhZzLLinfh5alNVZMQfITmOvn1A5YDQPSL5zIPXUeB7wVnwU/j5Bv58xid1gaA46+Yj6YxcGIPelE+BBd30mX6dTaZzgsTgvda6Q785mf7APgASpvf4DWONlkLgPZPmU9RvjpRkQ/ILKu0ghIBZzJ92ScwH5V4V4YjsJ8FQPbsU5eempaZrHzQd3QWyvqyWzBmjRsA2wfg5XHyX3x3R/qPKS7cBAIhAAAn9tKi/q2dE3vLSS4hGQ80I8oB0I4J0ua39j+UY0EgWevZMEpRvjaEaJCXA8CHe2QDyJzwMnvuwmTf/doWuAPIykkDwAPLI8bt1feCs+BjtbJD8lLIMu1e6wIALKniGqAgBNdMhprIbl9BQh41AG8u/LoZZN2GAdH9nUcpzrdeDaD933T/0zzBRx1mW12w6NfnAeBtnq/CHnb2O6oBUj362ucmE2uccWpdAFjq9vG2anrn+gA4BAJATQIvJ7mEbB9g+UtfrwagoA8g5xaEv4Bki/sAuXyL+gDFABztwMnsEgDSQCd+Iw30nS2b1HKCABBnq6or/p/5XnAWugz++diHgdYFADFOwQe5hSfyYWowCiTKDIYAhSgAWAo/Ed3LfLD0xye4w+JGSB6A3CgQHIkHyeZGgUSUXL5Fo0A2M1gvzfBt+Lh4KYSZCJM5pAny3CAAgp8psKz+XnAWcmyMt4OoBuhLuT6A7UOaIWrjZ2Jc3YRYTsA8gGweSURwQirYDPhNBQC5eQAmvW6qTjbfCYanmsu3aB6gEIDDLXu9jJUCAOccbBwEwHJiJtNE4kuTZu4sGHtNHmowNT5IrQsAYhDl5NfnqoGLZoLlFO2bIIQ8IFLRzQ2JAU5IBxMzwb/BVgAggv/ym2gdw+GWcUuTLATg+Pe3Jp96xowCwXzfgDPBPPMyALJrHEoAYMdiFEiN2xymXdgv/MEOBkC3rnTioLWVPQumBpXMEryxasQADFSzsTcK4hIBEExpc+aJsnkq0lBFAASTWswz+lZxXCIAwunRl7bWYX1kXCIASFGLACBFLQKAFLUIAFLUageA+s/ONnv8tVBHO3rRm+8OEelnPuEz+fwzFSP5aB4Lp3W41dHCmLY3eOAmZXrqLDfX1SRN+IBouXH0XJ7IqtGD16ygQMtVUEBrAMAcrJpcDUDVDhHs6GlVEifLfQsAkE3reLeb56OO297gYS4iGWtkLqo9AITbNAQgV6AVKiig8QMgLqoOAKsPgEdsys8KFH/BrhGdzAK3vcGD9BNgjWn257YAsMtLaquRB+ULqAMA7HYNmT0U7IYIcIMBswVDfp8HeV/mK2VOPGGuY2mXTvruEMEfm31GLhnOPjletKnDTC1+sw+L8IeoWjEoVtsbPCzVnTgtH5kN3p7ieDdzwCYEygaWL0MlcbwLTKYML0I92lEPHOCdNmSC6LDNO18IVc6SL6D2AQDbNeT3UJDOBzcYsFswFOzzoBaDiUbKvskLPLVy7LNDxLHZy01u6QNdq2hTBxn1q2CtvIKlbbW9wYM2qTLL7zzxxwzGM8/L5BICZYMWnzKGSmIOTGYzZOaJGxsRJAidB+SdL4QqZ8kXUOsAHIPdDvJ7KIgNEeAGA3YLhmO8z4Ne4c8v8k3wpLlaCxpihwiw+FE9JmNc67hwUwe9lHpq4nazEq7lDR5McNiaBPGKnlQQCcGyAeWrz9OUBDKZvCAR6rvZrTdggtB5YN65QqhwloIC6qQPoHc7KNlDAW4wALZgYHCbBPOMl2JY3zPQWnwFAI5Zf4cIYKh5BgAQIQuAqXSmDCbWpo7b3eBBmhS6DUPxip5VEwnBssk9H4dLYhO2gLJ9ALP1Bkww7zzg6U6YYoWzFBRQ+wCA3Q7wcnr0PHimeZmJCJ7yNY9y2Of4trMAOO4QUQVA0aYOmlZZDPap2Q7U6gYP0g4YABgPDgSjhEDZwPKVKYCSQCZjrHAUSHgJLOyCx69BKYEUK5yloIC6aAKZ3Q7K9lCwGwzghzmyuzgsxRYmJQD47xChzmkuHoB8DD05DiLkAODepauJrgBodYMHHBLZxnasixICZZPfIwPeIqDJGDMAyH448BJY2AXOo/u8uBAqnKUPAKA1y/dQ0BsM4Cf9ivZ5yPbjCwBw3SFCdoL50+P/cIL8e7t4Uwddm6R56gvuBIC2N3gwJtWdYDlyU6sG0GWTKV+GawBoMnW68DFSWANMCw4X1AAgxQpn6QMAuNtB5R4KcoMBuwVDyT4P2U0RCgBw3iFCDIOq+6E5XbF1QtWmDjzc55TzdAJA2xs8KMDwMOiKPoBICJZNQR8A9JKAyRgrBwAmmHceeAMAKVY4S4cAaG3nd1nI7aEANxiwWzCU7PMgB8Ef7Wjz4UdkdQ3gtkOEGjRTnTEGtk4o3tQBNn3BPbl1tbzBg37EGU2ErRgFkvmCssntkQHLEJpMXlAxADBBeLggb5tihbN02Ak2ABzvwrICj5CDcWG4wYDZggFGBGG1l+qSNsOgAXaI0I1hnvyXD+DWCSBJAMDSJKxT6GYYFI2xh9/gQXfEzFKIJ3C8onkAGReWDSwzlv0OTCbTLgEAJIicB+SdK4QKZ+lwGFRrG+52gPdQsBsioA0GzBYMeJ+HP/qKnM9NvfQrW/qjzAsMbhx77RBhFsP9YzkVDLZOKNzUQUddgh35u1kM1O4GD3rBgFoM90Ymnk6zICFQNrB8uUBJMGAylWEJACBBvC2YzTtXCFXOki+gcSyHrmpZLNtodh+/9ssN7uRmRPtway0eCG7FpNksQi8aMSlWOUu+gMYPQAp1F+tvKvToaX16y05aQK2rfZNak4VPsfpu2c1iuNCq7FvO+92HRDQzVb0666YF1LpaNik0WfgUq5wlX0BrAMDRThcjLxXZT078ivzY2QMxbatlkwKTtZBihbN09kAMiTQSEQCkqEUAkKIWAUCKWgQAKWoRAKSoRQCQohYBQIpaBAApahEApKhFAJCiFgFAiloEAClqEQCkqEUAkKIWAUCKWgQAKWoRAKSoRQCQohYBQIpaBAApahEApKhFAJCiFgFAiloEAClqEQCkqEUAkKJWYAD4KwGSiZ984w/jBMLatYn9e7/+QcSvbbHABZD+JaW/fgvpFtKHRkn69z+R/g/UT5F+gPQ9oUT+9723kK5DfR/pBtLl5DLQBaRXoEqvM+mtZp2o7L20DvEJAALAWesQnwAgAJy1DvGjBmBBAHjJN/6i5/wJAALAS94APJ+qduirXEHzJwAIAC95xn9eAFCXgKtXcwQQAASAqwYAwPMKgHoEXL2aJ4AAIABc1T8AzxsA6hBw9WoBAQQAjQK5yhmA81zqsy8ACQFQIgKgbbkCcP48IIAAcBcBwNgIATh/HhJAALhrEABQH6CWRCGIT+fPIwKoD+AuAoCxkQCgSoF/DAkAu3hxcfEijQIVigBoW/UBMMXAwgJwUQBwkeYBivQq0veQPjBK0r//jvS/oH6C9A6S9OeF8mv8G8LteoW+mXwT6CLSN6BKr3MEAIAbUVAALioALtaOEdNMMAHQtvoG4KIBoD4BOYn8RfXrHj9qABICYKUQAOFGgYSRkgAAqAaoc3wCgAColHL+Z7lYuHkARwBwMygx/u9GAAFAAKwU8H9LgPqtcwAyHeGEgUEIh5OIHgDqA9QQ8H9BAFDXfYDsUCgBQAC4qtE8wLPPFhPQ7ShQfjKMACAAXNVoJrgNAPQ8QOFvt7lyRwkAAiCYGq0FagUAORNc+Mvt24UEEAAEQDD1CcAlLv6h5Jng27eLCYAApL++8kryyis0CkSjQE7qEYBLlzQBxfFv3y4hAAAg/J8D8IqH/7sCsFT7ak2dMgXJEQBOAASzf30HDjkKdOmSIaAhACzj/wKAVzqeCT7amWzKT8e7k8f23TJmBIBUcwBC2r+BAxf6vxMAl6waA8Cw/0sAypcarpQDAEe/Bm2OvzXSIAAYXx8gqP2bOHCR/3sDUNwHqACAgQ4AAsB0KxppuH2A55AwDveMkvTvL5B+BvUjJOTWt+Si6IVaHP0e0k0oDN83ka4kV4CuIt2+XVWOWiPpA5SpCwDe5sqHwADYbkUjEQAEgJfaAYDl/D9LQBYA0K1ofP4OABztbLP5ZHLqoGF2ueQIACcAgtm/UwB0W7AGACzn/xkCMgDAJBufvwMAs1MHh1ubbLbZLLd8cgSAEwDB7N8lALY3BJy1DACW8/9iApJMBdANAEc7U7acpH8eYxADASAZIwDh7N8hAHA8YNU8AFAZAMzOA7BeAJilxp8TAL0BEMb+3QGAR8SMq7oDYGaCGescgLTuPdo5dXC0M/4m0CgBCGf/vgBYHV9sTsCqALDxRaqdAnC0Mzmxd7xbYX/eTZMzlqV3qUEAMM4+wGr719AgACjrA6jtOWoBoJLV/q/RqX3+rQyDCgDmfJiC19elyREALQ2D1rwBDRUAs0FN2SgQyN+kq/xfTGXWJaBVAJTrz0tG6wgAxtoFYPUNaKAAgC2aSuYBbP4gYev/tQlwBSCtg08dzLbLw/ICONwSps+MVdg3VA5Bi75PgKtuATS0f40bUE+jQFY1ACicCbb5AwBuW/+vS4DratATe3PeCSsvAaoB2qwB6tmfbkA1VdfspqCOd7eFW1cMw6W3qFSbTLdGS5LrHYBRjgLVsv/QagA7E7wy/su4BqjOH9YAb70FVjTWOif3eQBu1uqJGDFUkfbDym5TBABj7vMAK+xf8wbUy1qgVfFfHjwA+g4081qM4g7A+0ZJ+od3wP0E6l0k5JG3pZUSZS20b+4Pvg/1DSS8Ae6lBEzBXMIZ3IEqvU6fGqDa/nVuQEME4OWXAQE14lv/7wwA1Qadt/lEWEcALMYIQDj79w5AQSf4ZUBArfyB/3cFgKxh0/uLjwgAxlyHQUPZf7AAvFxzOsvOBAv/BwTUy3+czwMQACE0bACE6uYv7K0qDVWg4vUR9eI7dIK/KO89fa0GjR2AcPYfNQDiDSn261uQAPUClZX5+wHQ12pQAiCU/YcIAKvr//wVPcmH5vtzYpSOI/AcM68QWpW/CwAzM5VSOsBQO7neARjhKFBI+/cOQPE8QG3/v5Hc+FAfUOPUqf8/Z9+h9WF5AiZ/9xrATwQAY341gJ+GC4AwXy3/TwHQBJiZmufaByCMCADGou8EF8VX9quOeMMAcEN8B3OVHQAg5xkrltrWTa53AEbZBwhn/94BKOgDGANWRswA8B4EgLUOwOzUwXxTL7ZyFQHAmPtD8WHsP0AAgAWrImIA3oMAsNYB4MtLlnwx1viXQowSgHD2Hx8AYnkWWwFAu6NAcjHW4S/uiz93EQCMuS+GC2P/XgG4myoHwFPVAKgFiqsAYDX932MxHB+JIAD6WwwXxv59AnBXAHA3c7QaALNEVxOQqC4AIECGbHUmWMzAzLZbbQL9MyQMgH1OOkn/8JrnP4X6IRJeDi13t03ULrfI5b+PAt5A+haSuAMZvYOEFliXXqdTHyCY/XsEQPj/3eRuhoBKAMAidUVAIseA3rMENDsL12HQ2SYfifAahCAAhNyGQUPZvz8A7hoAMAFPPVWnAjDdAJ2/IaDhaQx3HoAAaFtDBUAT8FQ+EgYA5W/sDH9dregBWBAAXvIFYJEFwBBQ4P9VADDo//UJcATgeLf1iTACoELB7D9AAN55SqooUhUAmRA1T8N1Isyv9WmTIwDcJsJC2b9LAPA74csASA0n/L/4gZacfyclv9clwH0izF8EAGPuE2H+6hgA9eIo890AgEIB+xWmkvXuvgDwmoMHyREArhNh/uoWAPPqNHMEzQO8wMVWA5Dt4/YDgO+2rDa53gEY5ShQOPt3BgB4eaA5JkaB5McXXlAErASgOv+OABBvZ/AWAcCY664QoezfJwDCTWX8F7RGAoBejbsGo0CjBCCc/XsE4KYF4AUrTwC6GgUKokEAMMo+QBj1C4Dy0wX3VAAAq/b/X+WqzL+beYAgIgAYixaAmwaAmxgAttL/EQE2f7E4kq3PTPA/RcI42H0zkvQP+y5ag4lXg95Ekh68UJ6ME0HRHiBh3H6YQMIwAHehSq8zEgCyo0DlALCV/g8JMPmr5cEu598QgKOd7S76AARAiYLav7d5gAoASmX8/1eFF6D8zQJ5h/OnGmBUAARTrzPBCABWy/8Z9n9JgMrfPiHSkIDoAUgIAC+5xtelkMj2eh3/Zxn/FwT0AICpf9eiCTQ+AILav0MAxDNz9qsBQH6t4f8s6/+cgJ5qALnp/NJve2ICgDHnibBA9u8OAPXUqD2gAMgF/IAr/f8+l4wpDD8kAPRUfJuPRFIfoFzh7O8DgBiRrhvfPDdtD8k+gP0uykH6f0rA/fuKAOX/loABAKAXY7W5OzQBUK5w9vcA4NUmAICdA8Tro8wPFgBVEAqADxQA943/GwIwAHwPA9b1KBDflYCrzVckEQDlCmd/dwDUnGTyaq3Q3POF1S+pF6jpHwwAZm4xSwCwvSQAAqDe8ca6nAfgkoux5mvQBxglAOHs7wzAqwYAScB5rlwoYWj+Qfv/TfMKQRVCAwBm16sAEAL+r19yyOxMcDO5DoOKoQiv+w8BIOU2DBrK/qEAOH++iABlacYByPi/JsAFAGb937zl0/EyaB5gnKNAQeQCgNgNjH/AAJw/X0SAMXUKwM0SAHT+jQBgqgMAAKj7TrCs/PoAfiIAGPPrA/jJAYDU+5XvIQDOny8iANjafAkEgBICwI2A4T4SSQCUq69HIrX/pwS0DkDhKBDWFQyAEwGuneD2d4X4+0h/D8mCkaR/l5DeKxd2crnV50Jt+Ym39fwzqP+GhN5E/7MfJz8GehvpLajS63TrBPeyK4T1f0tAglpApQDcLQOgbBSocB4A60oWABcChvtEGAFQrp5WgwL/NwSI+CsBuKsBKB0FMgRUzARndIUTkAD/7w6AMCIAGBtVJxgDwMoA0Mt6EABZAnSauZng+rrCCUiA/xMABEAT+QLAbPyc/2MCRC9It4bKZoIbiwNwJQH+3yUAh1tpBew3D0MACLkBEMr+gQBgOf+HBKhxANUdxvIG4AoYdoC/igddVyfitRp07rc5xyAASEYJQDD7NxwFKgWA5fzfEsCqBsN8VqNeuXXrVnLrSrn/1yDAbx6gzdWgBEC5wtm/6TxA1v9z8YuebswAgLbx9wHglgDAEAB/un69JgHDXQ1KAJSrv9WgFzL+7wAAfpGLBwC3FAC38o/RX79el4Doa4BR9gF6qwGYWYWgJeJ/hkt+L3y+vcD/NQHufYBbBoBbud/aBmCN+gCjBKCvPgB4rPHTXCr+Zz5jCSje4KHA/xUBIwWARoFiHAUCjzV++tOKgMT4f5YAFBN3ANYAgBAiABgb1TyAsbH2/5SAxPo/JgBHFRbnH0oAqDloCUUAEAB+agqAtfGnrfIAFG3woEzOEADCJhKAuoOWUFUAtD0KtEZNoFGOAvXTBKoLQF7G5hiAt3T+td0VyY4CFajdeYAuOsHPV+j3jJL0D7sd2hz3QyS8Oe4VNZMohX9D0f53hX6S/AQIn8m3oEqvczydYGcAwF0HECBvCzz/+g0WLAVA8Y+tzgR3MQxKAJSrn2HQMAAw4P8pAT4AMAFAsyhZDXcirCMAFmMEoJ+JsBIAWP0WEOgHP3ggALizuOMBQLPzL43fUg2w8l22BABjLdYAtezvPwp05syZFf6fBYCpB1wUAHf8AHDaCwLEZ231AeaTbRi2JDkCoK0+QD37+84DnOEAnKn2/ywA5hFHBcAdDwDeT9x2QzFqbRQIPLdddp8iABhrbRSopv09Z4LPSADOnKmKdOVKsf9zAgQAd9z9XwHgTkBr8wDgue1MS9VsbbzgSpKk1/8XPecv/m9gV7J/C//XNWoTAMZSA4xyFKiG2qkBMjpjaoCKKuDKlevqFWxXxHdQA6Q3/4TXAE4zwUxsBpc4bomo5VQDyM2JD7cqN6cxDdRh9wHGCEBA+3cBgGrepEYW35Xn37kDAXBTTwAc7chbiv6/RHrrgtJABABjLgCEtH8HAJgGvgVA7do0VgDMnsRHO14blA0CgBF2gkPav30AwBCPBIA9gFuXLTz8vycAarQu6ydHADQGIKj9PSeSaowC5cY4376TAcAjfzAKVLx30Eo5AFA+vtBQBABjDgAEtb/vTKoCoCJEFoC3swDAwNW7SBbIzAOU7B63Uk4A2DsQAdAHAAHt77+UoNr/xSpcDcANLgRA5oGYuyJEIwIS5P/NCXDqA2zqA22+IeYG0nUkuxNMkv4hl//T/wr1n5H+BEkmsFAJvY+EAMDLoTEAf5n8JVBRBqv2bHLoAwS0f5C1NOVS69CB/6cElAJwV4VoQoDMv2IH6RrxmwJwuDXNfHDTIABIxgdASPu3C4B5EgP4/40bCAAQ/64JIQio17ftAwA9sjwvG2BukBwB4DAPEND+rQIAnkUC/s8JEBvgiu4viA9CsNrv/BLxq94hUCO+y2pQPsC8WRW2ZnIEgNtq0FD27wWAt/WrUFkZAPdqv/WRx698iUaN+MN8Jpj6AG2rSwBQeer3QHICFuxjLh4cAgDKYnX+BAAB4KK+APjgA0DA4uOPNQEeANyH/l9t74L4BAAB4KxQAHzsB8D9jP/XJoAAIAC8VG8UiH8pBOBjAwAk4F5zACQB943/1yWAACAAvFRrHkB+UUXJAAAPEADM+H8zAPT7xO5D/69JQPQAjHIUKIw6AIAB/1dFyjAACQDg/n3t/4CAWvkb/+8CAPOGtnZfkkcAlCio/dsGoFDW/7MA3L+n1WgeALxRr6MaQE7FLP22JiMAGPN6KD6A/XsB4IHx/xwAnABVa9Ty/1z+3QAgH0lqdzk09QHKFc7+/QDwQPv/AzsK9K66jd9D/YbG+XcDQBcbYxEA5ervDTE5OcUHo/YagHfffVcCgEaOHPJv5v+eG2O1uRoULy3G/mmdLEn/foL0V1B/gfQfkWQCC5UQpuinUP8F6X8g/SyBW+Uibj68D1V6nW41QCj79wMAWL2/eFf7v6wC0NyBU/6N/N+9D8BvQfM2+wAEQIWC2b8nAOzzW4t3jRgnwB+AbmaCxVCE1/2HAJByGwYNZf++ADDCALAQADTScOcBOgIgGScAIdQrAJe5eHwMACMAtAiAttUnAJcvKwIS7P8EgBEB0LZ6BOCyVhof+X9m/VBb+eP4w5wJpj5AicY/E2z9//LlBWPI/zPrh9rJPxM/6hpgfAAE01AAyKqJ//cEANibyUMEAGN+8wB+GioA7eefie8+E+wnAoAxv5lgPxEAzH0izKvxCZIjANwmwkLZnwBgbjXA2nSCRzkKFM7+AxgF6iN/HD/qTvAoAQijYcwD9JM/ij9MAL5XIQtGkv59gIRe8o498l2km0KJ/O/mj5EQAJgiBNhf/TSBIf8TEkqx9DrjBMDOBPeUP4zvAsDKl7TVTK53ABbjBCCU/Xt3wHH2Aeq8prNecgSA42rQQPYnAJjPPECbT4QRAOUKZ38CgA31iTACoFxjfyIMaJwAUA1ANYBSnACsUR9gnKNA69MHGEL8qEeBxgnA+owCDSE+zQOMD4AQIgCY6/MAIZZiDQSA8fUBgtq/dwccYR9ALUTxfCKbEQBSrg/EhLE/AcDcmkDyJT1r0AkeHwBCoexPADCfPsCM5gF67QP4258AYK4ALH1vQASAkCsAYew/TAA+4uomf0cA5qn1vZ/KqwbgOST8pvhXjJL0D7/kHS1C/hOkbyLZBLgwYT+C+ggJAfZnf578ORDmDeVdep1OAASzf+8AFMVXlu4s/6YAzEJYnxEAUs0BCGn/IQJgTN1V/o1HgUJYnxEAUg6jQAHtP0AAgK07yr9pDTAP8JJmnVzvACxGB0BQ+/cOQL4PMHwAmOyBeQ9EE+2j+NcAAA7cSURBVACMOa8FCmR/AoC5jgLx1Sh+exMQAIy5jwKFsT8BwIY6D0AArNZazgMUAWBeJxA8f7+Z4DZfkEEAVCmU/QcIgCZA2FAesS+UCZ6/+1og/27YIAAY4yhQQPv3DkDpPIAyIv8OXinWSv6NAahz45GDdcuqzZsIAMacAAho/0ECwKz/cwIeWOX7BYN9HkAUgHhkr3QjSwKAsdaeB6hp/2ECwBgwYwaAj2rFb5R/0xrg1+AtBX8Dx9MCUKYve3J1EACMrw8Q1P5dA5B7gV3JYrgKADABfdQAaSNUNUDTrlhZBcsL4HBLFEDZ3gUEAGMuNUBI+3cMQP4Vpg4AIAJ6nAirXo9ONUDbE2FB7B8agB9w6S/ClPDXgpdYjxSA1ZJjFZusYu1KNQB/F+nvID1rlKR/l5DuQr2N9CrSbwst5H+/jX9D0X6IhNj40YMEFM8DzNsPoEqvs7U+QC37BwYAXay6mdhf33knT0ANAFjG/8cBABNlcGJP7eABU9FKhqBF3yfA1cyuZP/QqmvRTneF6KgGSNa0Bqih4DUAulzQoNS/F9UApfmLp5vQTFh+gjjQ+be5LUrV26wIAMbaBmCV/QcLgHq+Dxwp9H8CgACo1FgBME+4gmPC/AOYB2ikwQOwrp1gpYEAcJ2rwSgQeMbbHFP2r8jf9fwJAALAWbUAuH4dEwDi1AbAFEB5/q7n33Qm+B80eBKDAAgOQFD7hx0GRVeb839DAIxSFwBQAuX5O55/89WgIR7IIwCkXFaDhrN/F/MA168DArIaIQDiodT2X5RNAJQqoP27mAlePwD4zhwB3tQ8CADGOQoUzP5drAWqBKDuKNDAAJD707f6omwCoEqh7N8yAPe4XADIzQMMC4CKVYgNRAAw5gZAOPu3C8A9dwBY4SzAIEaBxNZk1AfoEYCA9m8VgHv3MgQUhClZDFegQv9f41Ggv4X0N5Hs8ST9exbpG1DXka4gSVdfKJdH0b5xu1w3kd5L3gN6BwnlXXqdazUKhHTvXoaAokD1AWBF/v9J8sknn9RPIq+25wFWJUcAtDsPUKXuALhnTJCrDRsAUKBPBAA+BLQ9E7wqOQJgjVaDZgQAeD8VP6Tag/yQCuQFwCcKAA8CCAACwEuNADA9IkvA4nIqx7w/MQC4ExA9AAkB4KUmAIAxAU3A5eSyOwEEAAHgo85GgYT/5wFICbisAHAjgAAgAHzU1TyA9P8iAC4bAJwIKAXgAlf9848aAOoD+KnGTLD2/0IAFi0AcOFCfQIIAALASyvjv2/8PzgAJaNAFy40IIAAIAC8tDq+8f/MKNC9ezd9ASicB7hwoQkBBAAB4KVm8bH/+wNQNBNMABAA9dQDAAz5Pydg4eX/RfkTAI0AoFEgP7nEN/6fEuAzD1CcPwFAANRTVwC8xaU+A98XYomf/7Mkt1XQugDwN5D+GtJfN0rSv88g/R4U3vIW43BVKJH/XX0LCQX8FhJO8lYCN+bFqKBopde59gAok4rP9+5lCPDPP79Z1pqMAnUEwIIA8NLK+MamDEwNWwD8VoOyj5KC7eLWYx6AAGhbnQAAjAoXB2n/9wTgIwNAnoB6KRAABICXvABgLQHQQAQAAeAlHwD47wRAmQiAttUnAOZ3AqBMNArUtgYBgF/+BAAB4K4eR4EaxK9W4ShQExEABICXnOYBGsVfkb+f/xMA1Afwk8tMMPzRcx6gYCa4YXxGABAAHvKN7w1AgPgEAAHgLALAXQQAYwRAz/n3CgB/V+3ET77xJ4u+T4AnENauTezfewH0bX8Rv7bFWiiEnuOP/wR6zj6q+ATAAE+g5+yjik8ADPAEes4+qvgEwABPoOfso4pPAAzwBHrOPqr4BMAAT6Dn7KOKTwAM8AR6zj6q+ATAAE+g5+yjik8ADPAEes4+qvg9lxWJ1K8IAFLUIgBIUYsAIEUtAoAUtQgAUtQiAEhRiwAgRS0CgBS1CABS1CIASFGLACBFLQKAFLVCA3D4i/v8v+VkcmLPLYWjHb6rxabrCXjkHCD3ANfvqb4LoF/7N7/6wAAc7TzGz2CZZr90tMPhL/h4jk/O/rmHuH4/9V0A/drf4erDApCSx8/geHc7/TJz43gprsFRXjl75x7k+r3UdwH0a3+Xqw8KwHKyLS7gcGuafpu7Xcvcx2+8cvbOPcj1+6j3AujV/k5XH7oPIM9A1GOOMM8+nzYCtx2z98rZO3cW4vo91W8B9G3/5lffCgCy/eXWFDzaOXWQ2sHRBj45++fOAly/r/otgL7t3/zqBwcASMYlXhDX87iDjR8AkIxDtJ7tPxAA/JsAshnnEC9I48M1dxbs+t3VbwH0bf/emkBz3XLz6YPNbfPPdTQsTPfTYyyur07wQAqgb/sPpBPsMxgmz971HuI7DOeXOwtw/b7qtwD6tn/zq28FAK/pEHHizt0g34kYv9xDXL+nei6Anu3f/OrbAYBXps5WmKUVsXMb3Ctn/9xDXL+f+i6Afu3f/OppMRwpahEApKhFAJCiFgFAiloEAClqEQCkqEUAkKIWAUCKWgQAKWoRAKSoRQCQohYBQIpaBAApahEApKhFAJCiFgFAiloEAClqEQCkqEUAkKIWAUCKWgQAKWoRAKSoRQCQohYBQIpaBAApahEApKhFAJCi1jAAONziLwbhezqqbSGPd6czcWgu9us+3s1s9Xu0owLaPVCPdyeTiUymQml4Exf/UHDw6Iv97O/ZuSK2/zAA4O83Y7wc9LbA8021v/vs17lNj3Yy+wXnC0CmMFu1J2rZpsElpbKyQNdE8dp/IACwWWpue5/h5hBbxR998Xf5yxJyb0zIFYB6qcjx7gqTNSuA9EZY+wrGrWjtPxQAjnY2wTs9+C7X4q6zPPUfuA3EL0v5/pKjL35t8tgfcnvxTbC/pgw6V4b/v2J/ePO6FBBlX4fntj7a+a0duQ233I77cEtU3/oVKfyr+HUeSxUQrf2HAkB6zf/EvhlKviZhU1TF/D/+t5xMRTGJFwlyI/Kb1lLtA48aqTokjmLCywJI483TP5FJ+r+4A/EPvBkgbmc8cl9vuehBsdp/MACo7paQbHKmDUBeBar/5HtvRB9qW9SYstJVjU7YSDUhcRQTXhaAPCK6WfwXc5Df/ewrejxelzc2RWr/wQBwvDsxly0bhGnDk9sn/Y83QaUpuM34j+k/9m04DBeACYmjmPDS1lPT7lxOJvKATEuE16eS6/2trWK1/2AAmJ369zu6GpWWS+87fBRA/SePpXbStpvDAoBVsAmJo8wLCyBtdT72b9QdiLdYJ6LxKYb0ZORYAIjV/kMBgLf4lroSVreG2fZctkX5f9V3INNbStNpcgcSQXQVjBuconKPBoBo7T8QAA63hKmVBdRlL39ejIItTz49ZbANCmwn+k0yATMMV9QGnZq3x+ICkG8Wn+g2KGxwgkjrr3jtPwwAjnfF7UGOFjD9jtfDz/+CbBQKI9shBV178pdhmrcBitvX8S7/WjAKocvKjkLYUjzaSaOKMhelmXqBuBXZf9ZfEdt/EACkTT4J+nIim5KyulSzKnpyRQ8qm/4THIfmh8xUfG4cWt5a0Di0bYOe2ON3vpkeh9ZD3iLhOOYBYrb/IADIqXhesIb+uORz7UiBzqNR/uEUKkuv6w6oDs5jmACweWbx1f/77D57uLHxJP98NmMU/f3sHjv3pD0MP8PQuTqVB8wfFSpei5I9AauHG/vmc+386yavYsI8MgJZwkRKEiy/jLz9KzJefUHuimgtUEbZRSAcgNdPy89lADDmDkCxSlYjRgBA0SKc7gGIaDXoKqUAvL6xIUvg7G9+dmNjjx9Lj0zV931eEuc2Nk7rw+Iz17UNEZof+LkDWV7qYxoy/U8EBEfPviST51GmaZgpuyZD8R/PvZj+dpYfPq0Tfl173dmNjRf5ecigJn+ZS1H+IjF9evZM9fWZGFPpfDymzoMnm8Y+/VDkAi9ZZWcSYdZA2mA6iLwMnaY4m1ye2hg24wYXNAaNBwBbA6QF8Xpqb15Ir/NCSv+uSQcRrRl1WN0OeTE+VF+5J6tQ12QC/KNqAp1LkxfJquRTXTvNHj7+JHdx/eM56R0cC52wlkiGZ6SDKjB0Ljr5PZQYSEV/1CdgYlgAdB7CIunJCYffQ5essgNXYQ2kDaaCiMtgZ5/kLr0vLy2Xpz4Xm3H9CxqFxgjA1FbHD1W58n9AH+AhBsD8d46H0h91GhIAnoNMxib/8OcOrv2j02lQ86NI9OwUngKzWfJ/cFATzCa/h0KAVB5aB0MJWQB0HjLBqQyqWjLqkjOJmM8gmD0sAnG/v6bslc9zaqMgS9a5oFFo1ACcFa0i0QhNbW8AkIc1DOdEtc8r5g3eiz67pz9eUzdICcBDWa0/iV1n//WXHj84u29+PDeV6e+ZhLWuyUYVCPqkPa78TJ4lTgykoj5qp8ueUHrmKg9pkT3Z/Dg7hZesLwpdhTKQCmaCiMu4xq0q6JnCs8QAwIwbXNAYNGIAzm48adrGAAB92PYIX+ctU1Xq2o2YKckqAM7tnds/++bjBxkApvK7SFhn4goASkV8bA4AuOQqAFQwG4RnERwAbJbBa7wACLPnm0DmMB4RMjWzbgIBLy9tArFrv/n4wbkXn7T1vQLAVi8mE5cmkLn121O1zreyCWQAgJdc0QTSwcBhba9rCgDfJlDBBQ1dIwYgLYi097ZnO8V72gPEYeCA3FlkB21PhNIfp+L+l+0Eoy5G2gV+fGp7fBqANLpOWOvc6dJOsMiloM84tacHzlSfgAnGY6tO8GnQCbYAwEtW2SEApIGswUyQhxu2Yy3bL9k8wbmATnC9CxqFxgsAE+Oi/Bb00mf1eNy1jdPm8DU1DPm6HPvjbdONPTNqp8dR95kICIdBYQdXpLPP7ECfbqSn5a0SNsOg59AwqMlf5VI0ajgFp2c/mhNQwXhj/aXP7uuYL+YAQJesskMAKAPpYCCIHPbaeFGzncsTnAsYBq15QWPQSAAgtaqHuocUnwiAyMVbQWNqs4cWARC7rm2oNVZxigAgRS0CgBS1CABS1CIASFGLACBFLQKAFLUIAFLUIgBIUYsAIEUtAoAUtf4/O4AaypaqZlEAAAAASUVORK5CYII=" style="display: block; margin: auto;" /></p>
<p>Scenario 4 (evolution added) should show similar or slightly enhanced
matching compared to S3. Plasticity enables individuals to adjust
phenotypes toward local conditions, potentially improving matches.
Mutation allows evolutionary shifts in genotype_mean toward commonly
experienced environmental values. The combined effect should be modest
enhancement of the matching pattern established by tolerance alone.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Scenario 5: Habitat selection added</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co"># Expect strongest phenotype-environment matching from active spatial optimization</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="cf">if</span> (pop_s5 <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  <span class="fu">check_habitat_match</span>(sim_s5, </span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>                           <span class="at">color_by =</span> <span class="st">&quot;phenotype&quot;</span>, </span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>                           <span class="at">landscape_colors =</span> <span class="st">&quot;terrain&quot;</span>,</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>                           <span class="at">point_size =</span> <span class="fl">1.5</span>,</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>                           <span class="at">show_legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>}</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; Habitat Matching Statistics (colored by Phenotype ):</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt; ----------------------------</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt; Number of survivors: 338 </span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt; Phenotype distribution:</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt;   Mean: 0.543 </span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co">#&gt;   Range: 0.089 to 1.05 </span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt; Habitat value at survivor locations:</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt;   Mean: 0.584 </span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#&gt;   Range: 0.267 to 0.857 </span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co">#&gt; Phenotype-Habitat correlation:0.685</span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt;   -&gt; Positive match: individuals in habitat matching their phenotype</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Scenario 5 (habitat selection added) should show the strongest
phenotype-environment matching. Active habitat selection
(sampling_points=100) enables individuals to evaluate many locations and
preferentially settle where fitness is high. This behavioral mechanism
should produce clear spatial segregation: low-phenotype individuals
concentrated in low-value regions, high-phenotype individuals in
high-value regions, with minimal occupancy of mismatching
environments.</p>
<p>The visualizations confirm phenotype-environment matching across all
viable scenarios, validating TWoLife’s implementation of the fitness
model. Quantitatively, survivor phenotypes correlate positively with
occupied environmental values: S3 (r = NA), S4 (r = NA), S5 (r = NA).
These strong positive correlations verify that TWoLife correctly
implements the phenotype-environment matching mechanism.</p>
</div>
</div>
<div id="understanding-simulation-output" class="section level1">
<h1>Understanding Simulation Output</h1>
<div id="object-structure" class="section level2">
<h2>Object Structure</h2>
<p>Simulation objects are returned as lists containing four components
providing different levels of analytical detail. Understanding this
structure enables efficient data extraction and analysis:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Examine top-level structure</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">names</span>(sim_s5)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;summary&quot;    &quot;survivors&quot;  &quot;spatial&quot;    &quot;events&quot;     &quot;parameters&quot;</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co"># Summary component provides aggregated final statistics</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>sim_s5<span class="sc">$</span>summary</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt; $final_population_size</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; [1] 338</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt; $total_events</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt; [1] 29675</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; $duration</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt; [1] 250.0074</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt; $status</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#&gt; [1] &quot;surviving&quot;</span></span></code></pre></div>
<p>The <code>summary</code> component is a list containing final
population statistics: <code>final_population_size</code> (integer:
number surviving at simulation end), <code>total_births</code> (integer:
cumulative birth events), <code>total_deaths</code> (integer: cumulative
death events), <code>total_dispersals</code> (integer: cumulative
dispersal events), and <code>final_time</code> (numeric: simulation
duration in time units). This component provides quick overview of
population outcomes without requiring processing of detailed data.</p>
</div>
<div id="accessing-individual-level-data" class="section level2">
<h2>Accessing Individual-Level Data</h2>
<p>The <code>survivors</code> component is a data frame where each row
represents one surviving individual at simulation end. This enables
analysis of trait distributions, spatial patterns, and
phenotype-environment relationships among survivors:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Individual-level data showing traits and locations</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">isTRUE</span>(<span class="sc">!</span><span class="fu">is.null</span>(sim_s5<span class="sc">$</span>survivors) <span class="sc">&amp;&amp;</span> <span class="fu">is.data.frame</span>(sim_s5<span class="sc">$</span>survivors) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sim_s5<span class="sc">$</span>survivors) <span class="sc">&gt;</span> <span class="dv">0</span>)) {</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="co"># Display first three survivors</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="fu">head</span>(sim_s5<span class="sc">$</span>survivors, <span class="dv">3</span>)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  </span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  <span class="co"># Columns include:</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>  <span class="co"># individual_id: unique identifier</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>  <span class="co"># genotype: genotype_mean value (genetic optimum)</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>  <span class="co"># genotype_sd: tolerance (niche width)</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>  <span class="co"># phenotype: current expressed value (can differ from genotype via plasticity)</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>  <span class="co"># x, y: spatial coordinates</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>  <span class="co"># habitat_quality: environmental value at current location</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>  <span class="co"># fitness: current survival probability based on phenotype-environment match</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>}</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co">#&gt;      id         x          y  genotype phenotype width</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co">#&gt; 1 10855  1.937528 -0.4823305 0.4115576 0.4400777  0.15</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co">#&gt; 2 10969 -2.954147 -1.4135830 0.9374256 0.9166673  0.15</span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="co">#&gt; 3 11000 -6.099820 -1.5573425 0.4024616 0.3964505  0.15</span></span></code></pre></div>
<p>This data frame enables diverse analyses: trait distribution
statistics (mean, variance, range of genotypes), spatial pattern
analysis (clustering, dispersion), phenotype-environment correlation
(matching strength), and fitness distribution (population viability
indicators).</p>
</div>
<div id="accessing-event-history" class="section level2">
<h2>Accessing Event History</h2>
<p>The <code>events</code> component is a data frame recording every
demographic event that occurred during the simulation. This complete
history enables analysis of population dynamics, demographic rates over
time, and detailed process tracking:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># Event history showing complete demographic record</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">isTRUE</span>(<span class="sc">!</span><span class="fu">is.null</span>(sim_s5<span class="sc">$</span>events) <span class="sc">&amp;&amp;</span> <span class="fu">is.data.frame</span>(sim_s5<span class="sc">$</span>events) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(sim_s5<span class="sc">$</span>events) <span class="sc">&gt;</span> <span class="dv">0</span>)) {</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="co"># Display first three events</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  <span class="fu">head</span>(sim_s5<span class="sc">$</span>events, <span class="dv">3</span>)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  </span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  <span class="co"># Columns include:</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>  <span class="co"># time: when event occurred</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>  <span class="co"># event_type: &quot;birth&quot;, &quot;death&quot;, or &quot;dispersal&quot;</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  <span class="co"># individual_id: which individual (births create new IDs, deaths remove IDs)</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  <span class="co"># parent_id: for births, which individual reproduced (NA for deaths/dispersals)</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>  <span class="co"># x, y: location where event occurred</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>  <span class="co"># Plus trait values at time of event</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>  </span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>  <span class="co"># Event counts by type</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>  <span class="fu">table</span>(sim_s5<span class="sc">$</span>events<span class="sc">$</span>event_type)</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>}</span></code></pre></div>
<p>The events data enables temporal analysis: birth/death/dispersal
rates over time, population growth trajectory reconstruction, lineage
tracking (parent-offspring relationships), spatial dynamics (where
events occur), and demographic rate variation over simulation
duration.</p>
</div>
<div id="accessing-parameters" class="section level2">
<h2>Accessing Parameters</h2>
<p>The <code>parameters</code> component stores all input parameters,
ensuring complete reproducibility. Any simulation can be exactly
replicated by re-running with stored parameters:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># Parameters storage for reproducibility</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(sim_s5<span class="sc">$</span>parameters)) {</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  <span class="co"># Show structure (not full content—would be verbose)</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  <span class="fu">str</span>(sim_s5<span class="sc">$</span>parameters, <span class="at">max.level =</span> <span class="dv">1</span>)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  </span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  <span class="co"># Example: extract landscape parameters</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>  <span class="fu">names</span>(sim_s5<span class="sc">$</span>parameters<span class="sc">$</span>landscape_params)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  </span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  <span class="co"># Parameters include:</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  <span class="co"># landscape_params: landscape matrix and configuration</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>  <span class="co"># individual_params: initial population settings</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>  <span class="co"># genetic_params: trait values used</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>  <span class="co"># simulation_params: duration and stopping conditions</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>  <span class="co"># master_seed: ensures reproducibility</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>}</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="co">#&gt; List of 4</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="co">#&gt;  $ landscape :List of 6</span></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a><span class="co">#&gt;  $ individual:List of 12</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a><span class="co">#&gt;  $ genetic   :List of 6</span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a><span class="co">#&gt;  $ simulation:List of 4</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>This complete parameter storage facilitates comparison across
simulations (identify parameter differences), replication (re-run with
identical settings), and archiving (store complete simulation
specification).</p>
</div>
</div>
<div id="parameters-reference" class="section level1">
<h1>Parameters Reference</h1>
<p>This comprehensive reference documents all parameters accepted by
TWoLife functions, organized by parameter list. Each parameter includes
description, valid values, defaults, and interpretation guidance.</p>
<div id="landscape-parameters-landscape_params-list" class="section level2">
<h2>Landscape Parameters (<code>landscape_params</code> list)</h2>
<ul>
<li><strong>habitat</strong> (required): Numeric matrix of environmental
values. For binary landscapes, use 0=matrix (unsuitable) and 1=habitat
(suitable). For continuous landscapes, use values typically 0-1
representing environmental conditions (temperature, moisture, etc.).
Dimensions determine landscape size (e.g., 15×15 matrix = 225
cells).</li>
</ul>
</div>
<div id="individual-parameters-individual_params-list" class="section level2">
<h2>Individual Parameters (<code>individual_params</code> list)</h2>
<ul>
<li><p><strong>initial_population_size</strong> (required): Integer
specifying starting number of individuals. Must be positive. Typical
values: 20-200. Larger populations reduce extinction risk but increase
computation time.</p></li>
<li><p><strong>initial_positions</strong> (optional): Two-column matrix
specifying starting (x,y) coordinates for each individual. If NULL
(default), individuals are randomly placed in habitat cells (for binary
landscapes) or random cells (for continuous landscapes). Custom
placement enables testing specific initial configurations.</p></li>
<li><p><strong>initial_ages</strong> (optional): Vector of ages for
initial individuals. If NULL (default), all start at age 0. Custom ages
enable simulating populations with age structure.</p></li>
</ul>
</div>
<div id="genetic-parameters-genetic_params-list-optional" class="section level2">
<h2>Genetic Parameters (<code>genetic_params</code> list, optional)</h2>
<p>All genetic parameters accept either: - Single value (applied to all
individuals): e.g., <code>genotype_means = 0.5</code> - Vector of length
<code>initial_population_size</code> (individual-specific): e.g.,
<code>genotype_means = runif(40, 0.3, 0.7)</code></p>
<ul>
<li><p><strong>genotype_means</strong> (optional): Optimal environmental
values. Range: typically 0-1 matching landscape range. Default: 0.5 for
all individuals. Interpretation: environmental value where fitness is
maximized (fitness=1.0 when phenotype matches environment).</p></li>
<li><p><strong>genotype_sds</strong> (optional): Niche widths/tolerance
ranges. Range: &gt;0, typically 0.05-0.3. Default: 0.1. Interpretation:
standard deviation (σ) in Gaussian fitness function. Smaller values
create specialists (narrow tolerance), larger values create generalists
(broad tolerance). Value of 0.15 means ±0.3 (±2σ) range retains 95% of
fitness.</p></li>
<li><p><strong>mutation_rates</strong> (optional): Probability of
genetic change per reproduction. Range: 0-1, typically 0-0.1. Default: 0
(no evolution). Interpretation: per-birth probability that offspring
genotype_mean differs from parent. Enables evolutionary adaptation when
&gt;0.</p></li>
<li><p><strong>plasticities</strong> (optional): Rate of phenotypic
adjustment toward local environment. Range: 0-1. Default: 0 (no
plasticity). Interpretation: per-timestep rate of phenotype shift toward
local environmental value. 0=no adjustment (phenotype=genotype_mean),
1=complete immediate adjustment (phenotype=local environment within
tolerance), 0.3=30% adjustment per step.</p></li>
<li><p><strong>sampling_points</strong> (optional): Habitat selection
intensity. Range: ≥1 (integer). Default: 1 (random dispersal).
Interpretation: number of locations evaluated before dispersal. 1=random
movement (no selection), 10=moderate selectivity, 100=high selectivity
(approaching optimal placement). Higher values enable better habitat
matching but increase computation time.</p></li>
</ul>
</div>
<div id="simulation-parameters-simulation_params-list" class="section level2">
<h2>Simulation Parameters (<code>simulation_params</code> list)</h2>
<ul>
<li><p><strong>max_events</strong> (optional): Maximum number of
demographic events (births + deaths + dispersals). Must be positive
integer. Typical values: 250-1000. Simulation stops when this number is
reached or population goes extinct. Alternative to max_time.</p></li>
<li><p><strong>max_time</strong> (optional): Maximum simulation duration
in time units. Must be positive number. Alternative to max_events.
Simulation stops when time reaches this value or population goes
extinct.</p></li>
<li><p><strong>min_population_size</strong> (optional): Extinction
threshold. Default: 0 (only true extinction stops simulation). If set to
positive value (e.g., 5), simulation stops when population falls below
this threshold, enabling extinction risk analysis.</p></li>
<li><p><strong>max_population_size</strong> (optional): Carrying
capacity. Default: Inf (no limit). If set to finite value, prevents
population from exceeding this number, implementing density dependence
through recruitment limitation.</p></li>
</ul>
</div>
<div id="master-seed" class="section level2">
<h2>Master Seed</h2>
<ul>
<li><strong>master_seed</strong> (required): Integer for
reproducibility. Controls all random processes (initial placement,
demographic events, mutations, habitat selection). Using identical
master_seed with identical parameters produces exactly identical
results. Different seeds produce independent realizations (different
random events, same mechanisms).</li>
</ul>
</div>
</div>
<div id="computational-considerations" class="section level1">
<h1>Computational Considerations</h1>
<div id="performance" class="section level2">
<h2>Performance</h2>
<p>Simulation speed depends on multiple factors that users can control
through parameter choices:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Landscape size</strong>: Computational cost scales
quadratically with linear dimension. A 15×15 landscape (225 cells) is 4×
faster than 30×30 (900 cells), which is 4× faster than 60×60 (3600
cells). Recommendation: start with smaller landscapes (15-30 cells per
dimension) for exploration, increase to 50-100 for publication
analyses.</p></li>
<li><p><strong>Population size</strong>: Cost scales linearly with
number of individuals tracked. 50 individuals is 2× faster than 100,
which is 2× faster than 200. Recommendation: balance ecological realism
(larger populations reduce extinction risk and demographic
stochasticity) against computational cost.</p></li>
<li><p><strong>Habitat selection</strong>: Cost scales linearly with
<code>sampling_points</code> value. sampling_points=100 is 100× slower
than sampling_points=1 because each dispersal evaluates 100 locations
vs. 1. Recommendation: use sampling_points=1 for quick exploration,
increase to 10-100 when habitat selection is scientifically
important.</p></li>
<li><p><strong>Simulation duration</strong>: Cost scales linearly with
<code>max_events</code> or <code>max_time</code>. 1000 events takes 2×
as long as 500 events. Recommendation: determine minimum duration needed
for dynamics to equilibrate, then add 20-50% margin.</p></li>
</ol>
<p><strong>Typical performance:</strong> On standard laptop (2023): -
Small (15×15, N=50, 500 events, sampling=1): ~1-2 seconds - Medium
(30×30, N=100, 1000 events, sampling=10): ~5-15 seconds - Large (50×50,
N=200, 2000 events, sampling=100): ~30-120 seconds</p>
</div>
<div id="memory-usage" class="section level2">
<h2>Memory Usage</h2>
<p>Memory scales with event history storage, which grows linearly with
<code>max_events</code>. Each event requires ~200-500 bytes depending on
tracked attributes. For memory-intensive applications with very long
simulations (&gt;50,000 events), consider:</p>
<ol style="list-style-type: decimal">
<li>Running shorter simulations to equilibrium rather than
indefinitely</li>
<li>Periodically extracting and saving results, then restarting</li>
<li>Using smaller populations when scientifically justified</li>
</ol>
<p>Typical memory usage: &lt;100 MB for most applications, &lt;1 GB for
extreme cases (very long simulations or many replicates stored in
memory).</p>
</div>
<div id="reproducibility" class="section level2">
<h2>Reproducibility</h2>
<p>Complete reproducibility requires three conditions:</p>
<ol style="list-style-type: decimal">
<li><strong>Identical <code>master_seed</code></strong>: Same seed
guarantees identical random number sequences</li>
<li><strong>Same TWoLife version</strong>: Algorithm changes between
versions may affect results. Check version with
<code>packageVersion(&quot;TWoLife&quot;)</code>. Report version in
publications.</li>
<li><strong>Same R version</strong>: Numerical precision can vary across
R versions. For critical reproducibility (publications, archiving),
report R version (<code>R.version.string</code>) and consider using same
R version for replication.</li>
</ol>
<p>All parameters are stored in simulation output enabling exact
replication:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Replicate a simulation exactly using stored parameters</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>sim_replicate <span class="ot">&lt;-</span> <span class="fu">twolife_simulation</span>(</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  <span class="at">landscape_params =</span> sim_s5<span class="sc">$</span>parameters<span class="sc">$</span>landscape_params,</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  <span class="at">individual_params =</span> sim_s5<span class="sc">$</span>parameters<span class="sc">$</span>individual_params,</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  <span class="at">genetic_params =</span> sim_s5<span class="sc">$</span>parameters<span class="sc">$</span>genetic_params,</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>  <span class="at">simulation_params =</span> sim_s5<span class="sc">$</span>parameters<span class="sc">$</span>simulation_params,</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>  <span class="at">master_seed =</span> sim_s5<span class="sc">$</span>parameters<span class="sc">$</span>master_seed</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>)</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co"># Results should be identical</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="fu">identical</span>(sim_replicate<span class="sc">$</span>summary, sim_s5<span class="sc">$</span>summary)  <span class="co"># Should return TRUE</span></span></code></pre></div>
</div>
<div id="parallelization" class="section level2">
<h2>Parallelization</h2>
<p>For parameter sweeps or Monte Carlo replication, simulations can be
parallelized using R’s parallel processing capabilities. Each simulation
is independent, enabling perfect parallelization:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co"># Detect available cores (leave 1 for system)</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>n_cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co"># Example: replicate Scenario 3 (tolerance) 100 times with different seeds</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co"># to estimate distribution of population outcomes</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>n_reps <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span>n_reps, <span class="cf">function</span>(i) {</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>  <span class="fu">twolife_simulation</span>(</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>    <span class="at">landscape_params =</span> <span class="fu">list</span>(<span class="at">habitat =</span> continuous_landscape),</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>    <span class="at">individual_params =</span> <span class="fu">list</span>(<span class="at">initial_population_size =</span> <span class="dv">40</span>),</span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>    <span class="at">genetic_params =</span> <span class="fu">list</span>(</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>      <span class="at">genotype_means =</span> <span class="fu">runif</span>(<span class="dv">40</span>, <span class="fl">0.3</span>, <span class="fl">0.7</span>),  <span class="co"># New random genotypes each rep</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>      <span class="at">genotype_sds =</span> <span class="fu">rep</span>(<span class="fl">0.15</span>, <span class="dv">40</span>)</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>    ),</span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a>    <span class="at">simulation_params =</span> <span class="fu">list</span>(<span class="at">max_events =</span> <span class="dv">250</span>),</span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a>    <span class="at">master_seed =</span> <span class="dv">1000</span> <span class="sc">+</span> i  <span class="co"># Different seed per replicate</span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a>  )</span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a>}, <span class="at">mc.cores =</span> n_cores)</span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="co"># Extract and analyze distribution of outcomes</span></span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a>final_sizes <span class="ot">&lt;-</span> <span class="fu">sapply</span>(results, <span class="cf">function</span>(x) x<span class="sc">$</span>summary<span class="sc">$</span>final_population_size)</span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a><span class="fu">hist</span>(final_sizes, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Distribution of Final Population Sizes</span><span class="sc">\n</span><span class="st">(100 Replicates)&quot;</span>,</span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Final N&quot;</span>)</span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(final_sizes), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb23-28"><a href="#cb23-28" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">mean</span>(final_sizes), <span class="fu">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">4</span>]<span class="sc">*</span><span class="fl">0.9</span>, </span>
<span id="cb23-29"><a href="#cb23-29" tabindex="-1"></a>     <span class="fu">paste0</span>(<span class="st">&quot;Mean = &quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(final_sizes), <span class="dv">1</span>)), <span class="at">pos =</span> <span class="dv">4</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="discussion" class="section level1">
<h1>Discussion</h1>
<div id="what-twolife-enables" class="section level2">
<h2>What TWoLife Enables</h2>
<p><strong>Continuous environmental representation:</strong> Unlike most
individual-based models that discretize space into categorical habitat
types (suitable vs. unsuitable) <span class="citation">(DeAngelis and
Mooij 2005)</span>, TWoLife handles continuous environmental gradients
representing realistic spatial variation in conditions like temperature,
moisture, or resource availability. This enables investigation of
species responses to gradual environmental transitions, edge effects in
continuous space, and adaptive matching processes that would be obscured
by discrete classification.</p>
<p><strong>Individual-level genetic architecture:</strong> Each
individual possesses unique genetic values for optimal conditions
(genotype_mean), niche widths (genotype_sd), mutation rates, plasticity
coefficients, and behavioral parameters—all heritable, mutable, and
mechanistically implemented through explicit fitness calculations. This
individual-level representation enables investigation of how genetic
variation structures population responses to environmental
heterogeneity, tracking lineages, analyzing trait evolution, and testing
hypotheses about necessary genetic diversity.</p>
<p><strong>Phenotype-environment matching framework:</strong> Fitness
emerges dynamically from Gaussian matching between individual traits and
local conditions rather than pre-assigned habitat quality. This
mechanistic approach allows investigation of matching processes, local
adaptation trajectories, and niche evolution without assuming fitness
landscapes a priori. The explicit fitness function
(exp(-(phenotype-environment)²/(2×tolerance²))) enables quantitative
predictions about survival probability given any trait-environment
combination.</p>
<p><strong>Flexible mechanism integration:</strong> Users control which
mechanisms operate (genetic variation, tolerance, plasticity, evolution,
behavior) through parameter specification, enabling systematic
hypothesis testing about mechanism necessity and sufficiency. This
factorial capability supports experimental designs isolating mechanism
effects, as demonstrated in our five-scenario analysis where progressive
mechanism addition revealed their relative importance and
interactions.</p>
<p><strong>Complete transparency:</strong> All individual traits,
locations, fitness values, and demographic events are tracked throughout
simulations and stored in accessible data frames. This supports
validation (verify mechanisms operate correctly through
phenotype-environment correlation analysis), detailed analysis of
emergent patterns (spatial distributions, trait evolution), and lineage
tracking (parent-offspring relationships through event history). The
complete transparency distinguishes TWoLife from “black box” models
where internal processes are opaque.</p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p><strong>TWoLife</strong> provides a flexible framework for simulating
populations as collections of genetically variable individuals
inhabiting spatially heterogeneous landscapes. Through systematic
experimentation, this vignette demonstrated:</p>
<p><strong>Core capabilities:</strong> - Generation of discrete habitat
patches and continuous environmental gradients with realistic spatial
structure through fractal algorithms - Individual-level tracking of
genetic traits (optimal values, tolerance, mutation, plasticity,
behavior), phenotypes, and fitness through complete demographic
histories - Flexible integration of evolutionary and behavioral
mechanisms through parameter control, enabling factorial experimental
designs - Complete reproducibility through parameter storage and master
seed control, with computational efficiency suitable for parameter
exploration (typical simulations complete in seconds to minutes)</p>
<p><strong>Key findings from our simulations:</strong> - Niche width
(tolerance ranges, genotype_sd parameter) is necessary and sufficient
for persistence in heterogeneous environments (Scenarios 1-3). The S2→S3
transition—adding tolerance while holding genetic diversity
constant—enabled the shift from extinction (N=0) to viability (N=470). -
Genetic diversity in optimal values alone, without physiological
flexibility (tolerance), is insufficient for viability in continuous
landscapes (Scenario 2: N=0 despite 40 different genotypes). Continuous
space rarely provides exact phenotype-environment matches required by
specialists with zero tolerance. - Evolution (mutation + plasticity) and
behavior (habitat selection) enhance survival but cannot compensate for
lack of fundamental tolerance (Scenarios 4-5). These mechanisms add -132
individuals (-28.1% increase) beyond tolerance alone—substantial but
secondary to tolerance’s enabling effect. - Mechanisms interact in
hierarchical rather than simply additive fashion: tolerance is
prerequisite for viability, with evolution and behavior providing
enhancements that amplify tolerance’s effects rather than operating
independently.</p>
<p><strong>Scientific value:</strong> - Enables investigation of
questions that are challenging for models lacking either individual
variation or continuous spatial heterogeneity: How does tolerance
breadth affect habitat availability? How do phenotype-environment
matching processes structure populations? When is genetic diversity
necessary vs. sufficient? - Supports hypothesis testing about mechanism
necessity and sufficiency through systematic parameter manipulation, as
demonstrated by the five-scenario experimental design isolating
tolerance, evolution, and behavior effects. - Provides quantitative
predictions about population outcomes emerging from individual-level
processes and trait-environment interactions, with explicit fitness
functions enabling calculation of expected survival probability for any
trait-environment combination. - Facilitates reproducible,
mechanistically explicit research workflows through complete parameter
storage, output transparency, and helper functions for result extraction
and visualization.</p>
<p>By integrating spatial heterogeneity and individual variation within
a unified simulation framework, TWoLife advances capacity to understand
population dynamics, evolutionary processes, and conservation strategies
in realistic ecological contexts where environments vary continuously
and individuals differ genetically in their responses to conditions.</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Bolnick2011" class="csl-entry">
Bolnick, Daniel I., Priyanga Amarasekare, Miguel S. Araújo, Reinhard
Bürger, Jonathan M. Levine, Mark Novak, Volker H. W. Rudolf, Sebastian
J. Schreiber, Mark C. Urban, and David A. Vasseur. 2011. <span>“Why
Intraspecific Trait Variation Matters in Community Ecology.”</span>
<em>Trends in Ecology &amp; Evolution</em> 26 (4): 183–92. <a href="https://doi.org/10.1016/j.tree.2011.01.009">https://doi.org/10.1016/j.tree.2011.01.009</a>.
</div>
<div id="ref-Bolnick2003" class="csl-entry">
Bolnick, Daniel I., Richard Svänbäck, James A. Fordyce, Louie H. Yang,
Jeremy M. Davis, C. Darrin Hulsey, and Matthew L. Forister. 2003.
<span>“The Ecology of Individuals: Incidence and Implications of
Individual Specialization.”</span> <em>The American Naturalist</em> 161
(1): 1–28. <a href="https://doi.org/10.1086/343878">https://doi.org/10.1086/343878</a>.
</div>
<div id="ref-DeAngelis2005" class="csl-entry">
DeAngelis, Donald L., and Wolf M. Mooij. 2005. <span>“Individual-Based
Modeling of Ecological and Evolutionary Processes.”</span> <em>Annual
Review of Ecology, Evolution, and Systematics</em> 36: 147–68. <a href="https://doi.org/10.1146/annurev.ecolsys.36.102003.152644">https://doi.org/10.1146/annurev.ecolsys.36.102003.152644</a>.
</div>
<div id="ref-Grimm2005" class="csl-entry">
Grimm, Volker, and Steven F. Railsback. 2005. <em>Individual-Based
Modeling and Ecology</em>. Princeton, NJ: Princeton University Press.
</div>
<div id="ref-Hanski1999" class="csl-entry">
Hanski, Ilkka. 1999. <em>Metapopulation Ecology</em>. Oxford, UK: Oxford
University Press.
</div>
<div id="ref-Levins1969" class="csl-entry">
Levins, Richard. 1969. <span>“Some Demographic and Genetic Consequences
of Environmental Heterogeneity for Biological Control.”</span>
<em>Bulletin of the Entomological Society of America</em> 15 (3):
237–40. <a href="https://doi.org/10.1093/besa/15.3.237">https://doi.org/10.1093/besa/15.3.237</a>.
</div>
<div id="ref-Lynch1998" class="csl-entry">
Lynch, Michael, and Bruce Walsh. 1998. <em>Genetics and Analysis of
Quantitative Traits</em>. Sunderland, MA: Sinauer Associates.
</div>
<div id="ref-Turner1989" class="csl-entry">
Turner, Monica G. 1989. <span>“Landscape Ecology: The Effect of Pattern
on Process.”</span> <em>Annual Review of Ecology and Systematics</em>
20: 171–97. <a href="https://doi.org/10.1146/annurev.es.20.110189.001131">https://doi.org/10.1146/annurev.es.20.110189.001131</a>.
</div>
<div id="ref-Wiens1976" class="csl-entry">
Wiens, John A. 1976. <span>“Population Responses to Patchy
Environments.”</span> <em>Annual Review of Ecology and Systematics</em>
7: 81–120. <a href="https://doi.org/10.1146/annurev.es.07.110176.000501">https://doi.org/10.1146/annurev.es.07.110176.000501</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
